"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_transactionSummary_transactionOverview_tagExplorer_tsx"],{"./app/components/gridEditable/sortLink.tsx":(e,t,r)=>{r.d(t,{Z:()=>p});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react-router/es/index.js"),i=r("./app/components/links/link.tsx"),o=r("./app/icons/index.tsx"),s=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{align:t,title:r,canSort:n,generateSortLink:i,onClick:o,direction:l,replace:p}=e;const m=i();if(!m||!n)return(0,s.tZ)(d,{align:t,children:r});const g=l?(0,s.tZ)(u,{size:"xs",direction:"desc"===l?"down":"up"}):null;return(0,s.BX)(c,{align:t,to:m,onClick:e=>{p&&(e.preventDefault(),a.browserHistory.replace(m)),o?.(e)},children:[r," ",g]})}l.displayName="SortLink";const c=(0,n.Z)((e=>{const{align:t,css:r,...n}=e;return(0,s.tZ)(i.Z,{...n})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(e=>e.align?`text-align: ${e.align};`:""),";"),d=(0,n.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(e=>e.align?`text-align: ${e.align};`:""),";"),u=(0,n.Z)(o.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),p=l},"./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx":(e,t,r)=>{r.d(t,{Z:()=>l});var n=r("./app/utils/discover/genericDiscoverQuery.tsx"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){const{aggregateColumn:t}=e;return function(r){const{eventView:n}=r,a=n.getEventsAPIPayload(r.location);return a.aggregateColumn=t,a.sort=e.sort?e.sort:a.sort,e.allTagKeys&&(a.allTagKeys=e.allTagKeys),e.tagKey&&(a.tagKey=e.tagKey),a}}function o(e,t){return e.aggregateColumn!==t.aggregateColumn||e.sort!==t.sort||e.allTagKeys!==t.allTagKeys||e.tagKey!==t.tagKey}function s(e){return(0,a.tZ)(n.ZP,{route:"events-facets-performance",getRequestPayload:i(e),shouldRefetchData:o,...e})}s.displayName="SegmentExplorerQuery";const l=s},"./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx":(e,t,r)=>{r.d(t,{D_:()=>K,KZ:()=>D,e2:()=>E,xS:()=>N});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/react/index.js")),o=r("../node_modules/react-router/es/index.js"),s=r("./app/components/assistant/guideAnchor.tsx"),l=r("./app/components/button.tsx"),c=r("./app/components/charts/styles.tsx"),d=r("./app/components/gridEditable/index.tsx"),u=r("./app/components/gridEditable/sortLink.tsx"),p=r("./app/components/links/link.tsx"),m=r("./app/components/pagination.tsx"),g=r("./app/components/performanceDuration.tsx"),y=r("./app/locale.tsx"),h=r("./app/styles/space.tsx"),f=r("./app/utils/analytics.tsx"),x=r("./app/utils/discover/eventView.tsx"),k=r("./app/utils/discover/fields.tsx"),v=r("./app/utils/formatters.tsx"),w=r("./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx"),Z=r("./app/utils/queryString.tsx"),C=r("./app/utils/tokenizeSearch.tsx"),_=r("./app/views/discover/table/cellAction.tsx"),b=r("./app/views/performance/utils.tsx"),S=r("./app/views/performance/transactionSummary/filter.tsx"),q=r("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),T=r("./app/views/performance/transactionSummary/utils.tsx"),j=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const z="tags_cursor",D=[{key:"key",field:"key",name:"Tag Key",width:-1,column:{kind:"field"}},{key:"tagValue",field:"tagValue",name:"Tag Values",width:-1,column:{kind:"field"}},{key:"aggregate",field:"aggregate",name:"Avg Duration",width:-1,column:{kind:"field"},canSort:!0},{key:"frequency",field:"frequency",name:"Frequency",width:-1,column:{kind:"field"},canSort:!0},{key:"comparison",field:"comparison",name:"Compared To Avg",width:-1,column:{kind:"field"},canSort:!0},{key:"sumdelta",field:"sumdelta",name:"Total Time Lost",width:-1,column:{kind:"field"},canSort:!0}],E=(e,t,r)=>{const n=S.BW[e];return n||((0,b.C$)(t,r)===b.iy.FRONTEND?"measurements.lcp":"transaction.duration")};function N(e){return(0,j.tZ)("div",{className:"truncate",children:e.row.tags_value})}N.displayName="TagValue";class K extends i.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{widths:[]}),(0,n.Z)(this,"handleResizeColumn",((e,t)=>{const r=[...this.state.widths];r[e]=t.width?Number(t.width):d.z7,this.setState({widths:r})})),(0,n.Z)(this,"getColumnOrder",(e=>{const{widths:t}=this.state;return e.map(((e,r)=>"number"==typeof t[r]?{...e,width:t[r]}:e))})),(0,n.Z)(this,"renderHeadCellWithMeta",((e,t,r)=>(n,a)=>this.renderHeadCell(e,t,n,r[a]))),(0,n.Z)(this,"handleTagValueClick",((e,t,r)=>{const{organization:n}=this.props;(0,f.Gi)("performance_views.summary.tag_explorer.tag_value",{organization:n});const a=(0,Z.ro)(e.query.query),i=new C.MY(a??"");i.addFilterValues(t,[r]);const s=i.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(s).trim()}})})),(0,n.Z)(this,"handleCellAction",((e,t,r)=>n=>{const{eventView:a,location:i,organization:s}=this.props;(0,f.Gi)("performance_views.summary.tag_explorer.cell_action",{organization:s});const l=(0,T.xf)(a.query);(0,_.rh)(l,n,{...e,name:r.id},t),o.browserHistory.push({pathname:i.pathname,query:{...i.query,[z]:void 0,query:l.formatString()}})})),(0,n.Z)(this,"renderBodyCell",((e,t,r)=>{const n=r[t.key],{location:a,organization:i,transactionName:o}=e;if("key"===t.key){const e=(0,q.vG)({orgSlug:i.slug,transaction:o,projectID:(0,Z.ro)(a.query.project),query:{...a.query,tagKey:r.tags_key}});return(0,j.tZ)(p.Z,{to:e,onClick:()=>this.onTagKeyClick(),children:r.tags_key})}const s=[_.eX.ADD,_.eX.EXCLUDE];if("tagValue"===t.key){const e={...r,id:r.tags_key};return(0,j.tZ)(_.ZP,{column:t,dataRow:e,handleCellAction:this.handleCellAction(t,r.tags_value,e),allowActions:s,children:(0,j.tZ)("div",{className:"truncate",children:r.tags_value})})}if("frequency"===t.key)return(0,j.tZ)(A,{children:(0,v.rl)(r.frequency,0)});if("comparison"===t.key){const e=r.comparison,t=(0,v.rl)(e-1,0);return(0,j.tZ)(A,{children:e>1?(0,y.t)("+%s slower",t):(0,y.t)("%s faster",t)})}return"aggregate"===t.key?(0,j.tZ)(A,{children:(0,j.tZ)(g.Z,{abbreviation:!0,milliseconds:r.aggregate})}):"sumdelta"===t.key?(0,j.tZ)(A,{children:(0,j.tZ)(g.Z,{abbreviation:!0,milliseconds:r.sumdelta})}):n})),(0,n.Z)(this,"renderBodyCellWithData",(e=>(t,r)=>this.renderBodyCell(e,t,r)))}onSortClick(e,t){const{organization:r}=this.props;(0,f.Gi)("performance_views.summary.tag_explorer.sort",{organization:r,field:t,direction:e})}renderHeadCell(e,t,r,n){const{location:a}=this.props,i=(0,k.qG)(r.key,r.type,t),o={field:r.key,width:r.width},s=e.sortForField(o,t),l=(0,x.M3)(o,t),c=s?s.kind:void 0,d=s?s.field:void 0;return(0,j.tZ)(u.Z,{align:i,title:n.name,direction:c,canSort:l,generateSortLink:function(){if(!t)return;const r=e.sortOnField(o,t),{sort:n}=r.generateQueryStringObject();return{...a,query:{...a.query,[z]:void 0,tagSort:n}}},onClick:()=>this.onSortClick(c,d)})}onTagKeyClick(){const{organization:e}=this.props;(0,f.Gi)("performance_views.summary.tag_explorer.visit_tag_key",{organization:e})}render(){const{eventView:e,organization:t,location:r,currentFilter:n,projects:a,transactionName:o}=this.props,l=(0,Z.ro)(r.query?.tagSort),c=(0,Z.ro)(r.query?.[z]),u=e.clone();u.fields=D;const p=(0,x.vp)(l),m=u.withSorts(p.length?p:[{field:"sumdelta",kind:"desc"}]),g=E(n,a,m),y=((e,t,r)=>{const n=D.map((e=>({...e}))),a=n.find((e=>"aggregate"===e.key));return a?S.BW[e]?(a.name="Avg Span Duration",n):(0,b.C$)(t,r)===b.iy.FRONTEND?(a.name="Avg LCP",n):n:n})(n,a,m),h=this.getColumnOrder(y),f=m.getSorts();return(0,j.tZ)(w.Z,{eventView:m,orgSlug:t.slug,location:r,aggregateColumn:g,limit:5,cursor:c,children:e=>{let{isLoading:n,tableData:a,pageLinks:l}=e;return(0,j.BX)(i.Fragment,{children:[(0,j.tZ)(s.Z,{target:"tag_explorer",children:(0,j.tZ)(L,{transactionName:o,location:r,organization:t,pageLinks:l})}),(0,j.tZ)(d.ZP,{isLoading:n,data:a&&a.data?a.data:[],columnOrder:h,columnSortBy:f,grid:{renderHeadCell:this.renderHeadCellWithMeta(m,a?.meta||{},y),renderBodyCell:this.renderBodyCellWithData(this.props),onResizeColumn:this.handleResizeColumn},location:r})]})}})}}function L(e){const{pageLinks:t,organization:r,location:n,transactionName:a}=e,i=(0,q.vG)({orgSlug:r.slug,transaction:a,projectID:(0,Z.ro)(n.query.project),query:{...n.query}});return(0,j.BX)(V,{children:[(0,j.tZ)("div",{children:(0,j.tZ)(c.OT,{children:(0,y.t)("Suspect Tags")})}),(0,j.tZ)(l.zx,{onClick:()=>{(0,f.Gi)("performance_views.summary.tag_explorer.change_page",{organization:r})},to:i,size:"xs","data-test-id":"tags-explorer-open-tags",children:(0,y.t)("View All Tags")}),(0,j.tZ)(B,{pageLinks:t,onCursor:(e,t,n)=>{(0,f.Gi)("performance_views.summary.tag_explorer.change_page",{organization:r}),o.browserHistory.push({pathname:t,query:{...n,[z]:e}})},size:"xs"})]})}K.displayName="TagExplorer",L.displayName="TagsHeader";const A=(0,a.Z)("div",{target:"e1ihnfmd2"})({name:"p2k0n3",styles:"text-align:right;font-variant-numeric:tabular-nums;width:100%"}),V=(0,a.Z)("div",{target:"e1ihnfmd1"})("display:grid;grid-template-columns:1fr auto auto;margin-bottom:",(0,h.D)(1),";align-items:center;"),B=(0,a.Z)(m.Z,{target:"e1ihnfmd0"})("margin:0 0 0 ",(0,h.D)(1),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_transactionSummary_transactionOverview_tagExplorer_tsx.119eacfc6d7cc62835fd92e57dc0596e.js.map