(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_components_monitorForm_tsx-node_modules_lodash_groupBy_js"],{"./app/utils/slugify.tsx":(e,t,n)=>{"use strict";function o(e){return e.normalize("NFKD").toLowerCase().replace(" ","-").replace(/[^a-z0-9-_]/g,"")}n.d(t,{Z:()=>o})},"./app/views/monitors/components/monitorForm.tsx":(e,t,n)=>{"use strict";n.d(t,{G:()=>O,Z:()=>D});var o=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),i=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("../node_modules/react/index.js"),r=n("../node_modules/mobx-react-lite/es/index.js"),l=n("./app/components/alert.tsx"),a=n("./app/components/forms/fields/numberField.tsx"),c=n("./app/components/forms/fields/radioField.tsx"),u=n("./app/components/forms/fields/selectField.tsx"),d=n("./app/components/forms/fields/sentryProjectSelectorField.tsx"),p=n("./app/components/forms/fields/textField.tsx"),m=n("./app/components/forms/form.tsx"),h=n("./app/components/forms/model.tsx"),f=n("./app/components/links/externalLink.tsx"),g=n("./app/components/list/index.tsx"),y=n("./app/components/list/listItem.tsx"),x=n("./app/components/text.tsx"),Z=n("./app/data/timezones.tsx"),b=n("./app/locale.tsx"),v=n("./app/styles/space.tsx"),w=n("./app/utils/isActiveSuperuser.tsx"),_=n("./app/utils/slugify.tsx"),k=n("./app/utils/theme.tsx"),j=n("./app/utils/usePageFilters.tsx"),E=n("./app/utils/useProjects.tsx"),I=n("./app/views/monitors/utils.tsx"),C=n("./app/views/monitors/types.tsx"),S=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=[[C.Ix.CRONTAB,(0,b.t)("Crontab")],[C.Ix.INTERVAL,(0,b.t)("Interval")]],A="cron_job",N="0 0 * * *",O=30;function R(e,t){return t.fields.toJSON().reduce(((e,t)=>{let[n,o]=t;return n.startsWith("config.")?(e.config??={},"config.schedule.frequency"!==n&&"config.schedule.interval"!==n||Array.isArray(e.config.schedule)||(e.config.schedule=[1,"hour"]),Array.isArray(e.config.schedule)&&"config.schedule.frequency"===n?(e.config.schedule[0]=parseInt(o,10),e):Array.isArray(e.config.schedule)&&"config.schedule.interval"===n?(e.config.schedule[1]=o,e):(e.config[n.substr(7)]=o,e)):(e[n]=o,e)}),{})}function q(e){if(void 0===e.config)return e;const{config:t,...n}=e;return{...n,...Object.fromEntries(Object.entries(t).map((e=>{let[t,n]=e;return[`config.${t}`,n]})))}}function B(e){let{monitor:t,submitLabel:n,apiEndpoint:i,apiMethod:a,onSubmitSuccess:u}=e;const d=(0,s.useRef)(new h.Z({transformData:R,mapFormErrors:q})),{projects:p}=(0,E.Z)(),{selection:g}=(0,j.Z)(),[y,x]=(0,s.useState)(t?.config.schedule_type===C.Ix.CRONTAB?t?.config.schedule:N),v=g.projects[0],B=v?p.find((e=>e.id===v+"")):null,D=(0,w.M)(),G=p.filter((e=>D||e.isMember)),W=(0,I.Z)(y);return(0,S.tZ)(m.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:i,apiMethod:a,model:d.current,initialData:t?{name:t.name,slug:t.slug,type:t.type??A,project:t.project.slug,...function(e,t){const n={};return"cron_job"===e&&(n["config.schedule_type"]=t.schedule_type,n["config.checkin_margin"]=t.checkin_margin,n["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(n["config.schedule.frequency"]=t.schedule[0],n["config.schedule.interval"]=t.schedule[1]):(n["config.schedule"]=t.schedule,n["config.timezone"]=t.timezone)),n}(t.type,t.config)}:{project:B?B.slug:null,type:A},onSubmitSuccess:u,submitLabel:n,children:(0,S.BX)(F,{symbol:"colored-numeric",children:[(0,S.tZ)(P,{children:(0,b.t)("Add a name and project")}),(0,S.tZ)(X,{children:(0,b.t)("The monitor name will show up in alerts and notifications")}),(0,S.BX)(K,{children:[(0,S.tZ)(V,{name:"name",placeholder:(0,b.t)("My Cron Job"),required:!0,stacked:!0,inline:!1}),t&&(0,S.tZ)(V,{name:"slug",help:(0,b._N)("The [strong:monitor-slug] is used to uniquely identify your monitor within your organization. Changing this slug will require updates to any instrumented check-in calls.",{strong:(0,S.tZ)("strong",{})}),placeholder:(0,b.t)("monitor-slug"),required:!0,stacked:!0,inline:!1,transformInput:_.Z}),(0,S.tZ)(L,{name:"project",projects:G,placeholder:(0,b.t)("Choose Project"),disabled:!!t,disabledReason:(0,b.t)("Existing monitors cannot be moved between projects"),valueIsSlug:!0,required:!0,stacked:!0,inline:!1})]}),(0,S.tZ)(P,{children:(0,b.t)("Choose your schedule type")}),(0,S.tZ)(X,{children:(0,b._N)("You can use [link:the crontab syntax] or our interval schedule.",{link:(0,S.tZ)(f.Z,{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,S.tZ)(K,{children:(0,S.tZ)(c.Z,{name:"config.schedule_type",choices:T,defaultValue:C.Ix.CRONTAB,orientInline:!0,required:!0,stacked:!0,inline:!1})}),(0,S.tZ)(P,{children:(0,b.t)("Choose your schedule")}),(0,S.tZ)(X,{children:(0,b.t)("How often you expect your recurring jobs to run.")}),(0,S.BX)(K,{children:[void 0!==t&&(0,S.tZ)(l.ZP,{type:"info",children:(0,b.t)("Any changes you make to the execution schedule will only be applied after the next expected check-in.")}),(0,S.tZ)(r.Qj,{children:()=>{const e=d.current.getValue("config.schedule_type");return"crontab"===e?(0,S.BX)(J,{children:[(0,S.tZ)(V,{name:"config.schedule",placeholder:"* * * * *",defaultValue:N,css:(0,o.iv)({input:{fontFamily:k.ZP.text.familyMono}},"",""),required:!0,stacked:!0,onChange:x,inline:!1}),(0,S.tZ)(z,{name:"config.timezone",defaultValue:"UTC",options:Z.f,required:!0,stacked:!0,inline:!1}),W&&(0,S.BX)(H,{children:['"',W,'"']})]}):"interval"===e?(0,S.BX)(J,{interval:!0,children:[(0,S.tZ)(U,{children:(0,b.t)("Every")}),(0,S.tZ)(M,{name:"config.schedule.frequency",placeholder:"e.g. 1",defaultValue:"1",required:!0,stacked:!0,inline:!1}),(0,S.tZ)(z,{name:"config.schedule.interval",options:(t=Number(d.current.getValue("config.schedule.frequency")??1),[{value:"minute",label:(0,b.tn)("minute","minutes",t)},{value:"hour",label:(0,b.tn)("hour","hours",t)},{value:"day",label:(0,b.tn)("day","days",t)},{value:"week",label:(0,b.tn)("week","weeks",t)},{value:"month",label:(0,b.tn)("month","months",t)},{value:"year",label:(0,b.tn)("year","years",t)}]),defaultValue:"day",required:!0,stacked:!0,inline:!1})]}):null;var t}})]}),(0,S.tZ)(P,{children:(0,b.t)("Set a missed status")}),(0,S.tZ)(X,{children:(0,b.t)("The number of minutes we'll wait before we consider a check-in as missed.")}),(0,S.tZ)(K,{children:(0,S.tZ)(M,{name:"config.checkin_margin",placeholder:"Defaults to 0 minutes",stacked:!0,inline:!1})}),(0,S.tZ)(P,{children:(0,b.t)("Set a failed status")}),(0,S.tZ)(X,{children:(0,b.t)("The number of minutes a check-in is allowed to run before it's considered failed.")}),(0,S.tZ)(K,{children:(0,S.tZ)(M,{name:"config.max_runtime",placeholder:`Defaults to ${O} minutes`,stacked:!0,inline:!1})})]})})}B.displayName="MonitorForm";const D=B,F=(0,i.Z)(g.Z,{target:"epnopid10"})({name:"yrf9ut",styles:"width:600px"}),M=(0,i.Z)(a.Z,{target:"epnopid9"})({name:"1hcx8jb",styles:"padding:0"}),z=(0,i.Z)(u.Z,{target:"epnopid8"})({name:"1hcx8jb",styles:"padding:0"}),V=(0,i.Z)(p.Z,{target:"epnopid7"})({name:"1hcx8jb",styles:"padding:0"}),L=(0,i.Z)(d.Z,{target:"epnopid6"})({name:"1hcx8jb",styles:"padding:0"}),P=(0,i.Z)(y.Z,{target:"epnopid5"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";font-weight:bold;line-height:1.3;"),U=(0,i.Z)(x.Z,{target:"epnopid4"})("font-weight:bold;color:",(e=>e.theme.subText),";"),X=(0,i.Z)(U,{target:"epnopid3"})("font-weight:normal;padding-left:",(0,v.D)(4),";"),K=(0,i.Z)("div",{target:"epnopid2"})("padding-left:",(0,v.D)(4),";margin-top:",(0,v.D)(1),";margin-bottom:",(0,v.D)(4),";display:flex;flex-direction:column;gap:",(0,v.D)(1),";"),J=(0,i.Z)("div",{target:"epnopid1"})("display:grid;align-items:center;gap:",(0,v.D)(1),";grid-template-columns:",(e=>e.interval&&"auto")," 1fr 2fr;"),H=(0,i.Z)(U,{target:"epnopid0"})("font-weight:normal;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-family:",(e=>e.theme.text.familyMono),";grid-column:auto/span 2;")},"./app/views/monitors/types.tsx":(e,t,n)=>{"use strict";let o,i,s,r;n.d(t,{Ix:()=>i,NI:()=>r,wo:()=>s}),function(e){e.UNKNOWN="unknown",e.CRON_JOB="cron_job"}(o||(o={})),function(e){e.CRONTAB="crontab",e.INTERVAL="interval"}(i||(i={})),function(e){e.OK="ok",e.ERROR="error",e.DISABLED="disabled",e.ACTIVE="active",e.MISSED_CHECKIN="missed_checkin",e.TIMEOUT="timeout"}(s||(s={})),function(e){e.OK="ok",e.ERROR="error",e.IN_PROGRESS="in_progress",e.MISSED="missed",e.TIMEOUT="timeout"}(r||(r={}))},"./app/views/monitors/utils.tsx":(e,t,n)=>{"use strict";n.d(t,{J:()=>c,Z:()=>a});var o=n("../node_modules/cronstrue/dist/cronstrue.js"),i=n.n(o),s=n("./app/locale.tsx"),r=n("./app/utils/dates.tsx"),l=n("./app/views/monitors/types.tsx");function a(e){if(!e)return null;let t;try{t=i().toString(e,{verbose:!0,use24HourTimeFormat:(0,r.gn)()})}catch(e){return null}return t}function c(e){if(e.schedule_type===l.Ix.CRONTAB)return a(e.schedule)??(0,s.t)("Unknown schedule");const[t,n]=e.schedule;return"minute"===n?(0,s.tn)("Every minute","Every %s minutes",t):"hour"===n?(0,s.tn)("Every hour","Every %s hours",t):"day"===n?(0,s.tn)("Every day","Every %s days",t):"week"===n?(0,s.tn)("Every week","Every %s weeks",t):"month"===n?(0,s.tn)("Every month","Every %s months",t):(0,s.t)("Unknown schedule")}},"../node_modules/lodash/groupBy.js":(e,t,n)=>{var o=n("../node_modules/lodash/_baseAssignValue.js"),i=n("../node_modules/lodash/_createAggregator.js"),s=Object.prototype.hasOwnProperty,r=i((function(e,t,n){s.call(e,n)?e[n].push(t):o(e,n,[t])}));e.exports=r}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_components_monitorForm_tsx-node_modules_lodash_groupBy_js.7f7f7d774790137dd33175683f214d0f.js.map