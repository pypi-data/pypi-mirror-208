"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_modals_widgetBuilder_addToDashboardModal_tsx"],{"./app/components/modals/widgetBuilder/addToDashboardModal.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>B,modalCss:()=>z});var s=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(a("../node_modules/core-js/modules/es.array.push.js"),a("../node_modules/react/index.js")),o=a("./app/actionCreators/dashboards.tsx"),d=a("./app/actionCreators/indicator.tsx"),n=a("./app/components/button.tsx"),r=a("./app/components/buttonBar.tsx"),l=a("./app/components/forms/controls/selectControl.tsx"),c=a("./app/locale.tsx"),p=a("./app/styles/space.tsx"),u=a("./app/utils/handleXhrErrorResponse.tsx"),h=a("./app/utils/performance/contexts/metricsCardinality.tsx"),g=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),m=a("./app/utils/useApi.tsx"),w=a("./app/utils/withDomainRequired.tsx"),b=a("./app/views/dashboards/types.tsx"),x=a("./app/views/dashboards/utils.tsx"),y=a("./app/views/dashboards/widgetBuilder/utils.tsx"),f=a("./app/views/dashboards/widgetCard/index.tsx"),v=a("./app/views/organizationContext.tsx"),Z=a("./app/views/performance/landing/metricsDataSwitcher.tsx"),D=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C=(0,c.t)("Select a dashboard");function A(e){let{Header:t,Body:a,Footer:s,closeModal:r,location:p,organization:A,router:B,selection:z,widget:_,widgetAsQueryParams:j}=e;const q=(0,m.Z)(),[k,E]=(0,i.useState)(null),[M,P]=(0,i.useState)(null),[O,R]=(0,i.useState)(null);(0,i.useEffect)((()=>{let e=!1;return(0,o.j2)(q,A.slug).then((t=>{e||E(t)})),()=>{e=!0}}),[q,A.slug]),(0,i.useEffect)((()=>{let e=!1;return O===y.i0||null===O?P(null):(0,o.AK)(q,A.slug,O).then((t=>{e||P(t)})),()=>{e=!0}}),[q,A.slug,O]);const U=null!==O;return(0,D.BX)(v.g.Provider,{value:A,children:[(0,D.tZ)(t,{closeButton:!0,children:(0,D.tZ)("h4",{children:(0,c.t)("Add to Dashboard")})}),(0,D.BX)(a,{children:[(0,D.tZ)(S,{children:(0,D.tZ)(l.Z,{disabled:null===k,menuPlacement:"auto",name:"dashboard",placeholder:(0,c.t)("Select Dashboard"),value:O,options:k&&[{label:(0,c.t)("+ Create New Dashboard"),value:"new"},...k.map((e=>{let{title:t,id:a,widgetDisplay:s}=e;return{label:t,value:a,disabled:s.length>=b.ZU,tooltip:s.length>=b.ZU&&(0,c._N)("Max widgets ([maxWidgets]) per dashboard reached.",{maxWidgets:b.ZU}),tooltipOptions:{position:"right"}}}))],onChange:e=>{e.disabled||R(e.value)}})}),(0,D.tZ)(S,{children:(0,c.t)("Any conflicting filters from this query will be overridden by Dashboard filters. This is a preview of how the widget will appear in your dashboard.")}),(0,D.tZ)(h.BT,{organization:A,location:p,children:(0,D.tZ)(Z.d,{organization:A,eventView:(0,x.tT)(_.title,_.queries[0],z,_.displayType),location:p,hideLoadingIndicator:!0,children:e=>(0,D.tZ)(g.kP,{location:p,forceTransactions:e.forceTransactionsOnly,children:(0,D.tZ)(f.ZP,{organization:A,isEditing:!1,widgetLimitReached:!1,selection:M?(0,x.fK)(M):z,dashboardFilters:(0,x.lM)(p)??M?.filters,widget:_,showStoredAlert:!0})})})})]}),(0,D.tZ)(s,{children:(0,D.BX)(T,{gap:1.5,children:[(0,D.tZ)(n.zx,{onClick:async function(){if(null===M)return;let e=_.queries[0].orderby;b.FO.AREA&&_.queries[0].columns.length||(e="");const t=_.queries[0],a={..._,title:""===_.title?(0,c.t)("All Events"):_.title,queries:[{...t,orderby:e}]};try{const e={...M,widgets:[...M.widgets,a]};await(0,o.Y)(q,A.slug,e),r(),(0,d.S9)((0,c.t)("Successfully added widget to dashboard"))}catch(e){const t=(0,c.t)("Unable to add widget to dashboard");(0,u.Z)(t)(e),(0,d.Iw)(t)}},disabled:!U||O===y.i0,title:U?void 0:C,children:(0,c.t)("Add + Stay in Discover")}),(0,D.tZ)(n.zx,{priority:"primary",onClick:function(){const e=O===y.i0?`/organizations/${A.slug}/dashboards/new/widget/new/`:`/organizations/${A.slug}/dashboard/${O}/widget/new/`;B.push((0,w.D)({pathname:e,query:{...j,...M?(0,x.aq)(M):{}}})),r()},disabled:!U,title:U?void 0:C,children:(0,c.t)("Open in Widget Builder")})]})})]})}A.displayName="AddToDashboardModal";const B=A,S=(0,s.Z)("div",{target:"enumv91"})("margin-bottom:",(0,p.D)(2),";"),T=(0,s.Z)(r.ZP,{target:"enumv90"})("@media (max-width: ",(e=>e.theme.breakpoints.small),"){grid-template-rows:repeat(2, 1fr);gap:",(0,p.D)(1.5),";width:100%;>button{width:100%;}}"),z={name:"jzg5s9",styles:"max-width:700px;margin:70px auto"}}}]);
//# sourceMappingURL=../sourcemaps/app_components_modals_widgetBuilder_addToDashboardModal_tsx.0124415758f17e55e6785d05932b3189.js.map