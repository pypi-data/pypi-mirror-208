"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_webServiceView_index_tsx"],{"./app/components/charts/components/markArea.tsx":(t,e,n)=>{function r(t){return{...t}}n.d(e,{Z:()=>r}),n("../node_modules/echarts/lib/component/markArea.js")},"./app/components/charts/lineChart.tsx":(t,e,n)=>{n.d(e,{w:()=>s});var r=n("./app/components/charts/series/lineSeries.tsx"),a=n("./app/components/charts/baseChart.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(t){let{series:e,seriesOptions:n,...s}=t;return(0,i.tZ)(a.Z,{...s,series:e.map((t=>{let{seriesName:e,data:a,dataArray:i,...s}=t;return(0,r.Z)({...n,...s,name:e,data:i||a?.map((t=>{let{value:e,name:n}=t;return[n,e]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}s.displayName="LineChart"},"./app/components/gridEditable/sortLink.tsx":(t,e,n)=>{n.d(e,{Z:()=>u});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react-router/es/index.js"),i=n("./app/components/links/link.tsx"),s=n("./app/icons/index.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(t){let{align:e,title:n,canSort:r,generateSortLink:i,onClick:s,direction:l,replace:u}=t;const m=i();if(!m||!r)return(0,o.tZ)(c,{align:e,children:n});const h=l?(0,o.tZ)(p,{size:"xs",direction:"desc"===l?"down":"up"}):null;return(0,o.BX)(d,{align:e,to:m,onClick:t=>{u&&(t.preventDefault(),a.browserHistory.replace(m)),s?.(t)},children:[n," ",h]})}l.displayName="SortLink";const d=(0,r.Z)((t=>{const{align:e,css:n,...r}=t;return(0,o.tZ)(i.Z,{...r})}),{target:"esdhr0u2"})("display:block;width:100%;white-space:nowrap;color:inherit;&:hover,&:active,&:focus,&:visited{color:inherit;}",(t=>t.align?`text-align: ${t.align};`:""),";"),c=(0,r.Z)("div",{target:"esdhr0u1"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";"),p=(0,r.Z)(s.CC,{target:"esdhr0u0"})({name:"40f4ru",styles:"vertical-align:top"}),u=l},"./app/components/performance/layouts/index.tsx":(t,e,n)=>{n.d(e,{c:()=>i});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("./app/styles/space.tsx");const i=(0,r.Z)("div",{target:"ez22r7r0"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,a.D)(2),";grid-row-gap:",(0,a.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(t=>t.theme.breakpoints.medium),"){",(t=>t.columns?`\n    grid-template-columns: repeat(${t.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${t.minSize}px, 1fr));\n    `),";}")},"./app/utils/performance/contexts/pageError.tsx":(t,e,n)=>{n.d(e,{De:()=>d,V_:()=>o,YY:()=>l});var r=n("../node_modules/react/index.js"),a=n("./app/components/alert.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const s=(0,r.createContext)({pageError:void 0,setPageError:t=>{}});function o(t){let{children:e}=t;const[n,a]=(0,r.useState)();return(0,i.tZ)(s.Provider,{value:{pageError:n,setPageError:a},children:e})}function l(){const{pageError:t}=(0,r.useContext)(s);return t?(0,i.tZ)(a.bZ,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:t}):null}o.displayName="PageErrorProvider",l.displayName="PageErrorAlert";const d=()=>(0,r.useContext)(s)},"./app/utils/useKeyPress.tsx":(t,e,n)=>{n.d(e,{Z:()=>a});var r=n("../node_modules/react/index.js");const a=(t,e)=>{const[n,a]=(0,r.useState)(!1),i=e??document.body;return(0,r.useEffect)((()=>{const e=e=>{let{key:n}=e;n===t&&a(!0)},n=e=>{let{key:n}=e;n===t&&a(!1)};return i.addEventListener("keydown",e),i.addEventListener("keyup",n),()=>{i.removeEventListener("keydown",e),i.removeEventListener("keyup",n)}}),[t,i]),n}},"./app/views/starfish/components/chartPanel.tsx":(t,e,n)=>{n.d(e,{Z:()=>o});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(n("../node_modules/react/index.js"),n("./app/components/panels/index.tsx")),i=n("./app/styles/space.tsx"),s=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(t){let{title:e,children:n,button:r}=t;return(0,s.tZ)(a.s_,{children:(0,s.BX)(a.N,{withPadding:!0,children:[(0,s.BX)(d,{children:[e&&(0,s.tZ)(l,{children:e}),r]}),n]})})}o.displayName="ChartPanel";const l=(0,r.Z)("p",{target:"e1tvnfsq1"})((t=>t.theme.text.cardTitle),";"),d=(0,r.Z)("div",{target:"e1tvnfsq0"})("padding:0 ",(0,i.D)(1)," 0 0;min-height:36px;width:100%;display:flex;align-items:center;justify-content:space-between;")},"./app/views/starfish/components/detailPanel.tsx":(t,e,n)=>{n.d(e,{Z:()=>y});var r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react/index.js"),i=n("./app/components/button.tsx"),s=n("./app/icons/iconClose.tsx"),o=n("./app/locale.tsx"),l=n("./app/styles/space.tsx"),d=n("./app/utils/useKeyPress.tsx"),c=n("./app/utils/useOnClickOutside.tsx"),p=n("../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js"),u=n("../node_modules/framer-motion/dist/es/render/dom/motion.mjs"),m=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const h="50vw",g=(0,a.forwardRef)(f);function f(t,e){let{collapsed:n,children:r}=t;return(0,m.tZ)(x,{ref:e,collapsed:n,initial:{opacity:0,x:h},animate:n?{opacity:0,x:h}:{opacity:1,x:0},transition:{type:"spring",stiffness:500,damping:50},children:r})}f.displayName="SlideOverPanel";const x=(0,r.Z)(u.E.div,{shouldForwardProp:t=>["animate","transition"].includes(t)||"collapsed"!==t&&(0,p.Z)(t),target:"e1iwvxg00"})("width:",h,";position:fixed;top:0;bottom:0;right:0;background:",(t=>t.theme.background),";color:",(t=>t.theme.textColor),";border-left:1px solid ",(t=>t.theme.border),";text-align:left;z-index:",(t=>t.theme.zIndex.sidebar-1),";",(t=>t.collapsed?"overflow: hidden;":"overflow-x: hidden;\n  overflow-y: scroll;"),";");function y(t){let{children:e,detailKey:n,onClose:r}=t;const[i,l]=(0,a.useState)({collapsed:!0}),p=(0,d.Z)("Escape");(0,a.useEffect)((()=>{n&&l({collapsed:!1})}),[n]);const u=(0,a.useRef)(null);return(0,c.Z)(u,(()=>{i.collapsed||(r?.(),l({collapsed:!0}))})),(0,a.useEffect)((()=>{p&&(i.collapsed||(r?.(),l({collapsed:!0})))}),[p]),(0,m.BX)(g,{collapsed:i.collapsed,ref:u,children:[(0,m.tZ)(Z,{children:(0,m.tZ)(v,{priority:"link",size:"zero",borderless:!0,"aria-label":(0,o.t)("Close Details"),icon:(0,m.tZ)(s.b,{size:"sm"}),onClick:()=>{l({collapsed:!0}),r?.()}})}),(0,m.tZ)(w,{children:e})]})}y.displayName="Detail";const v=(0,r.Z)(i.zx,{target:"e1clb2dw2"})("color:",(t=>t.theme.gray300),";&:hover{color:",(t=>t.theme.gray400),";}"),Z=(0,r.Z)("div",{target:"e1clb2dw1"})("justify-content:flex-end;display:flex;padding:",(0,l.D)(2),";"),w=(0,r.Z)("div",{target:"e1clb2dw0"})("padding:0 ",(0,l.D)(4),";")},"./app/views/starfish/views/webServiceView/index.tsx":(t,e,n)=>{n.r(e),n.d(e,{default:()=>ae});var r=n("../node_modules/react/index.js"),a=n("../node_modules/lodash/isEqual.js"),i=n.n(a),s=n("./app/actionCreators/tags.tsx"),o=n("./app/components/organizations/pageFilters/container.tsx"),l=n("./app/components/sentryDocumentTitle.tsx"),d=n("./app/locale.tsx"),c=n("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),p=n("./app/utils/useApi.tsx"),u=n("./app/utils/useOrganization.tsx"),m=n("./app/utils/usePrevious.tsx"),h=n("./app/utils/useProjects.tsx"),g=n("./app/utils/withPageFilters.tsx"),f=n("../node_modules/lodash/trimStart.js"),x=n.n(f),y=n("./app/components/gridEditable/index.tsx"),v=n("./app/components/performance/searchBar.tsx"),Z=n("./app/utils/discover/eventView.tsx"),w=(n("./app/utils/performance/vitals/constants.tsx"),n("./app/utils/queryString.tsx")),b=n("./app/utils/tokenizeSearch.tsx"),_=(n("./app/views/performance/trends/utils.tsx"),n("./app/views/starfish/utils/dates.tsx"));const k=["transaction"],q="equation|sum(transaction.duration) / total.transaction_duration",S=t=>t?.features?.includes("performance-landing-page-stats-period")?"14d":"7d";var T=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),E=n("./app/components/datePageFilter.tsx"),D=n("./app/components/layouts/thirds.tsx"),j=n("./app/components/organizations/pageFilterBar.tsx"),C=n("./app/components/projectPageFilter.tsx"),P=n("./app/styles/space.tsx"),L=n("./app/utils/performance/contexts/pageError.tsx"),B=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),z=n("../node_modules/lodash/isNil.js"),O=n.n(z),N=n("../node_modules/query-string/index.js"),F=n("./app/components/button.tsx"),$=n("./app/components/charts/eventsRequest.tsx"),A=n("./app/utils/formatters.tsx"),X=n("./app/utils/withApi.tsx"),Y=n("./app/views/starfish/components/breakdownBar.tsx"),V=n("./app/views/starfish/components/chart.tsx"),R=n("./app/views/starfish/components/detailPanel.tsx"),M=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const W=(0,X.Z)($.Z);function U(t){let{row:e,onClose:n,eventView:r,organization:a,location:i}=t;return O()(e)?null:(0,M.tZ)(R.Z,{detailKey:e?.endpoint,onClose:n,children:e&&r&&a&&i&&(0,M.tZ)(I,{row:e,eventView:r,organization:a,location:i})})}function I(t){let{row:e,eventView:n,organization:a}=t;const i=(0,B.u)(),{aggregateDetails:s,transaction:o,httpOp:l}=e,c=new b.MY(["has:http.method","transaction.op:http.server",`transaction:${o}`,`http.method:${l}`]);return(0,M.BX)("div",{children:[(0,M.tZ)("h2",{children:(0,d.t)("Endpoint Detail")}),(0,M.tZ)("p",{children:(0,d.t)("Details of endpoint. More breakdowns, etc. Maybe some trends?")}),(0,M.tZ)(J,{to:`/organizations/${a.slug}/starfish/endpoint-overview/?${N.stringify({endpoint:o,method:l,statsPeriod:n.statsPeriod,project:n.project,start:n.start,end:n.end})}`,children:(0,d.t)("Go to Endpoint Overview")}),(0,M.tZ)(G,{children:(0,d.t)("Endpoint URL")}),(0,M.tZ)("pre",{children:e?.endpoint}),(0,M.tZ)(W,{query:c.formatString(),includePrevious:!1,partial:!0,limit:5,interval:"1h",includeTransformedData:!0,environment:n.environment,project:n.project,period:n.statsPeriod,referrer:"starfish-homepage-count",start:n.start,end:n.end,organization:a,yAxis:["tpm()","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{results:e,loading:n}=t;return(0,M.tZ)(r.Fragment,{children:(0,M.BX)(K,{children:[(0,M.BX)(H,{children:[(0,M.tZ)(G,{children:(0,d.t)("Throughput")}),(0,M.tZ)(Q,{children:(0,A.Du)(s.tpm)}),(0,M.tZ)(V.Z,{statsPeriod:"24h",height:110,data:e?.[0]?[e?.[0]]:[],start:"",end:"",loading:n,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[0]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]}),(0,M.BX)(H,{children:[(0,M.tZ)(G,{children:(0,d.t)("p50(duration)")}),(0,M.tZ)(Q,{children:(0,A.g9)(s.p50/1e3,0,!0)}),(0,M.tZ)(V.Z,{statsPeriod:"24h",height:110,data:e?.[1]?[e?.[1]]:[],start:"",end:"",loading:n,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[i.charts.getColorPalette(0)[1]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]})]})})}}),(0,M.tZ)(Y.Z,{title:(0,d.t)("Where is time spent in this endpoint?"),transaction:e.transaction})]})}U.displayName="EndpointDetail",I.displayName="EndpointDetailBody";const G=(0,T.Z)("h3",{target:"e147b3ya4"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,P.D)(1),";"),Q=(0,T.Z)("h4",{target:"e147b3ya3"})({name:"3in70x",styles:"margin:0;font-weight:normal"}),K=(0,T.Z)("div",{target:"e147b3ya2"})("display:flex;&>div:last-child{padding-right:",(0,P.D)(1),";}"),H=(0,T.Z)("div",{target:"e147b3ya1"})("padding-right:",(0,P.D)(4),";flex:1;"),J=(0,T.Z)(F.zx,{target:"e147b3ya0"})("margin-bottom:",(0,P.D)(2),";");var tt=n("./app/components/performance/layouts/index.tsx"),et=n("./app/constants/chartPalette.tsx"),nt=n("../node_modules/lodash/max.js"),rt=n.n(nt),at=n("./app/components/charts/chartZoom.tsx"),it=n("./app/components/charts/lineChart.tsx"),st=n("./app/utils/discover/charts.tsx"),ot=n("./app/utils/useRouter.tsx");function lt(t){let{data:e,previousData:n,statsPeriod:r,start:a,end:i,utc:s,loading:o,height:l,grid:d,handleSpikeAreaClick:c}=t;const p=(0,ot.Z)(),u=(0,B.u)();if(!e||e.length<=0)return null;const m=[et.$[5][4]],h=function(t){const e=t.map((t=>t.data.map((t=>t.value))));return rt()(e.map(rt()))}(e),g={max:h,type:"value",splitNumber:4,axisLabel:{color:u.chartLabel,formatter:t=>(0,A.rl)(t,1)}},f={seriesOptions:{showSymbol:!1},grid:d,utc:s,isGroupedByDate:!0,showTimeInTooltip:!0,colors:m,tooltip:{trigger:"axis",valueFormatter:t=>(0,st.CX)(t,"percentage")}};return o?(0,M.tZ)(it.w,{height:l,series:[],...f}):(0,M.tZ)(at.Z,{router:p,period:r,start:a,end:i,utc:s,children:t=>(0,M.tZ)(it.w,{onClick:c,height:l,...t,series:e,previousPeriod:n,yAxis:g,tooltip:f.tooltip})})}lt.displayName="FailureRateChart";const dt=lt;var ct=n("./app/utils/queryClient.tsx"),pt=n("./app/utils/usePageFilters.tsx"),ut=n("./app/views/starfish/components/chartPanel.tsx"),mt=(n("../node_modules/core-js/modules/es.array.push.js"),n("./app/components/charts/components/markArea.tsx"));var ht=n("../node_modules/moment/moment.js"),gt=n.n(ht),ft=n("./app/components/charts/styles.tsx"),xt=n("./app/constants/index.tsx"),yt=n("./app/utils/discover/discoverQuery.tsx"),vt=n("./app/utils/useLocation.tsx"),Zt=n("./app/components/links/link.tsx"),wt=n("./app/components/pagination.tsx"),bt=n("./app/utils/discover/fieldRenderers.tsx");const _t=[{key:"transaction",name:"endpoint",width:350},{key:"count_if(http.status_code,greaterOrEquals,500)",name:"Errors",width:50},{key:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",name:"Error Rate",width:50}];function kt(t){let{location:e,organization:n,eventView:a,isLoading:i,tableData:s,pageLinks:o}=t;return(0,M.BX)(r.Fragment,{children:[(0,M.tZ)(y.ZP,{isLoading:i,data:s?s.data:[],columnOrder:_t,columnSortBy:a.getSorts(),grid:{renderHeadCell:function(t){return(0,M.tZ)(qt,{align:"left",children:t.name})},renderBodyCell:(t,r)=>function(t,r,a){if(!s||!s.meta)return r[t.key];const i=String(t.key),o=(0,bt.Js)(i,s.meta,!1)(r,{organization:n,location:e});if("transaction"===t.key){const t=r["http.method"]?`${r["http.method"]} `:"";return(0,M.BX)(Zt.Z,{to:{pathname:`/starfish/failure-detail/${r["http.method"]}:${encodeURIComponent(r.transaction)}`,query:{start:e.query.start,end:e.query.end}},children:[t,r.transaction]})}return o}(t,r)},location:e}),(0,M.tZ)(wt.Z,{pageLinks:o})]})}kt.displayName="FailureDetailTable";const qt=(0,T.Z)("div",{target:"elb0pee0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");function St(t){let{data:e,spike:n}=t;const r=(0,B.u)(),a=r.red300,i=1e7;if(!e||e.length<=0||!n)return null;const s=[{color:a,data:e[0].data.filter((t=>n?.startTimestamp-i<=parseInt(t.name,10)&&parseInt(t.name,10)<=n?.endTimestamp+i)),seriesName:"Failure Rate"},{seriesName:"Focused Area",color:a,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,mt.Z)({silent:!0,itemStyle:{color:a,opacity:.2},label:{show:!1},data:[[{name:"start",xAxis:n.startTimestamp,emphasis:{disabled:!1}},{name:"end",xAxis:n.endTimestamp,emphasis:{disabled:!1}}]]})}],o={splitNumber:3,type:"value",axisLabel:{color:r.chartLabel,formatter:t=>(0,A.rl)(t,1)}},l={seriesOptions:{showSymbol:!1},isGroupedByDate:!0,showTimeInTooltip:!0,color:a,tooltip:{trigger:"axis",valueFormatter:t=>(0,st.CX)(t,"percentage")},xAxis:{show:!1}};return(0,M.tZ)(it.w,{height:120,series:s,yAxis:o,...l})}St.displayName="FocusedFailureRateChart";const Tt=St;var Et=n("./app/utils/discover/fields.tsx");function Dt(t){let{organization:e,location:n,spike:a,transactions:i}=t;const s=[{key:"issue",name:"Issue",width:120},{key:"title",name:"Title",width:280},{key:"count_unique(user)",name:"Users",width:50},{key:"count()",name:"Count",width:50}];let o="event.type:error transaction:[";i?.forEach((t=>o+=`${t},`)),o=o.slice(0,o.length-1)+"]";const{query:l}=n,c=a?.startTimestamp&&a.endTimestamp,p={name:(0,d.t)("Failure Detail Issues"),projects:[],start:a?.startTimestamp?new Date(a?.startTimestamp).toUTCString():void 0,end:a?.endTimestamp?new Date(a?.endTimestamp).toUTCString():void 0,range:c?void 0:(0,w.ro)(l.statsPeriod)||xt.GY,fields:["issue","title","count()","count_unique(user)"],query:o,orderby:`-${(0,Et.LY)("count()")}`,version:2},u=Z.ZP.fromNewQueryWithLocation(p,n);return i?(0,M.tZ)(yt.Z,{eventView:u,orgSlug:e.slug,location:n,referrer:"api.starfish.failure-issue-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{let{pageLinks:a,isLoading:i,tableData:o}=t;return(0,M.BX)(r.Fragment,{children:[(0,M.tZ)(y.ZP,{isLoading:i,data:o?o.data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{renderHeadCell:t=>function(t,e){const n=(0,Et.qG)(e.name,e.type,t);return(0,M.tZ)(jt,{align:n,children:e.name})}(o?.meta,t),renderBodyCell:(t,r)=>function(t,r,a,i){if(!t||!t.meta)return a[r.key];const s=String(r.key);return(0,bt.Js)(s,t.meta,!1)(a,{organization:e,location:n})}(o,t,r)},location:n}),(0,M.tZ)(wt.Z,{pageLinks:a})]})}}):(0,M.tZ)(y.ZP,{isLoading:!0,data:[],columnOrder:s,columnSortBy:u.getSorts(),grid:{},location:n})}Dt.displayName="IssueTable";const jt=(0,T.Z)("div",{target:"e1985awp0"})("display:block;width:100%;white-space:nowrap;",(t=>t.align?`text-align: ${t.align};`:""),";");function Ct(t){let{chartData:e,spike:n,onClose:a}=t;const i=(0,vt.T)(),s=(0,u.Z)();if(O()(n))return null;const o=n?.startTimestamp&&n.endTimestamp;function l(){const t={name:(0,d.t)("Transaction Event Count"),projects:[],start:n?.startTimestamp?new Date(n?.startTimestamp).toUTCString():void 0,end:n?.endTimestamp?new Date(n?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||xt.GY,fields:["count_if(http.status_code,greaterOrEquals,500)"],query:"event.type:transaction",version:2},e={name:(0,d.t)("Error Event Count"),projects:[],start:n?.startTimestamp?new Date(n?.startTimestamp).toUTCString():void 0,end:n?.endTimestamp?new Date(n?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||xt.GY,fields:["count()"],query:"event.type:error",version:2};return(0,M.BX)(Bt,{children:[(0,M.BX)(zt,{children:[(0,M.tZ)(ft.OT,{children:(0,d.t)("Transaction Events")}),(0,M.tZ)(yt.Z,{eventView:Z.ZP.fromNewQueryWithLocation(t,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:n}=t;return(0,M.tZ)(Ot,{children:e?"—":n?.data[0]["count_if(http.status_code,greaterOrEquals,500)"]})}})]}),(0,M.BX)(zt,{children:[(0,M.tZ)(ft.OT,{children:(0,d.t)("Error Events")}),(0,M.tZ)(yt.Z,{eventView:Z.ZP.fromNewQueryWithLocation(e,i),orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},children:t=>{let{isLoading:e,tableData:n}=t;return(0,M.tZ)(Ot,{children:e?"—":n?.data[0]["count()"]})}})]}),(0,M.BX)(zt,{children:[(0,M.tZ)(ft.OT,{children:(0,d.t)("Users")}),(0,M.tZ)(Ot,{children:"—"})]})]})}const c={name:(0,d.t)("Failure Sample"),projects:[],start:n?.startTimestamp?new Date(n?.startTimestamp).toUTCString():void 0,end:n?.endTimestamp?new Date(n?.endTimestamp).toUTCString():void 0,range:o?void 0:(0,w.ro)(i.query.statsPeriod)||xt.GY,fields:["transaction","count_if(http.status_code,greaterOrEquals,500)","equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))","http.method","count_if(http.status_code,equals,200)"],query:"event.type:transaction has:http.method transaction.op:http.server count_if(http.status_code,greaterOrEquals,500):>0",version:2,orderby:"-count_if_http_status_code_greaterOrEquals_500"},p=Z.ZP.fromNewQueryWithLocation(c,i);return(0,M.BX)(R.Z,{detailKey:n?.startTimestamp.toString(),onClose:a,children:[(0,M.tZ)(Lt,{children:`${gt()(n?.startTimestamp).format("MMMM Do YYYY, h:mm:ss a")} - ${gt()(n?.endTimestamp).format("MMMM Do YYYY, h:mm:ss a")}`}),(0,M.tZ)("h4",{children:(0,d.t)("Error Spike Detail")}),n&&(0,M.tZ)(yt.Z,{eventView:p,orgSlug:s.slug,location:i,referrer:"api.starfish.failure-event-list",queryExtras:{dataset:"discover"},limit:5,children:t=>{const a=t?.tableData?.data.map((t=>t.transaction));return(0,M.BX)(r.Fragment,{children:[l(),(0,M.tZ)(Tt,{data:e,spike:n}),(0,M.tZ)(Pt,{children:(0,d.t)("Failing Endpoints")}),(0,M.tZ)(kt,{...t,location:i,organization:s,eventView:p}),(0,M.tZ)(Pt,{children:(0,d.t)("Related Issues")}),(0,M.tZ)(Dt,{location:i,organization:s,isLoading:t.isLoading,spike:n,transactions:a})]})}})]})}Ct.displayName="FailureDetailPanel";const Pt=(0,T.Z)("h5",{target:"e19lyfqb4"})("margin-bottom:",(0,P.D)(1),";"),Lt=(0,T.Z)("div",{target:"e19lyfqb3"})("color:",(t=>t.theme.red300),";margin-bottom:",(0,P.D)(4),";"),Bt=(0,T.Z)("div",{target:"e19lyfqb2"})("display:flex;flex-direction:row;margin-bottom:",(0,P.D)(2),";"),zt=(0,T.Z)("div",{target:"e19lyfqb1"})("display:flex;flex-direction:column;margin-right:",(0,P.D)(4),";margin-bottom:0;"),Ot=(0,T.Z)("div",{target:"e19lyfqb0"})({name:"kux9p6",styles:"font-weight:400;font-size:22px"});var Nt=n("./app/components/assistant/guideAnchor.tsx"),Ft=n("./app/components/gridEditable/sortLink.tsx"),$t=n("./app/components/tooltip.tsx"),At=n("./app/components/duration.tsx"),Xt=n("./app/components/searchBar.tsx"),Yt=n("./app/utils/discover/styles.tsx");const Vt=["endpoint","tpm","p50(duration)","p95(duration)"],Rt={[q]:"percentage"};function Mt(t){let{eventView:e,location:n,onSelect:a,organization:i,setError:s,columnTitles:o,dataset:l}=t;const[c,p]=(0,r.useState)([]),[u,m]=(0,r.useState)(e);function h(t){const e={};return t?.data?.[0]&&Object.keys(t.data[0]).forEach((t=>{t.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals")&&(e["p50()"]=t)})),(r,s)=>function(t,e,r,s){if(!t||!t.meta)return r[e.key];const o={...t.meta,...Rt},l=String(e.key),c=(0,bt.Js)(l,o,!1)(r,{organization:i,location:n});if("transaction"===l){let t="";r["http.method"]&&(t=`${r["http.method"]} `);const e={endpoint:`${t}${r.transaction}`,transaction:r.transaction,httpOp:r["http.method"],aggregateDetails:{failureCount:r["count_if(http.status_code,greaterOrEquals,500)"],p50:r["p50()"],tpm:r["tpm()"],p50Delta:r[s["p50()"]]}};return(0,M.BX)(Zt.Z,{onClick:()=>a(e),to:"",style:{display:"block",width:"100%"},children:[t,r.transaction]})}if(l===q){const t=Number(r["sum(transaction.duration)"]),e=Number(r[q]);return(0,M.tZ)($t.u,{title:(0,d.t)("This endpoint accounts for %s of the cumulative time on your web service",(0,A.rl)(e)),containerDisplayMode:"block",position:"top",children:(0,M.tZ)(Yt.Hw,{children:(0,d._N)("[cumulativeTime] ([cumulativeTimePercentage])",{cumulativeTime:(0,M.tZ)(At.Z,{seconds:t/1e3,fixedDigits:2,abbreviation:!0}),cumulativeTimePercentage:(0,A.rl)(e)})})})}if(l.startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")){const t=r[l],e=t<0?"good":t>0?"bad":"neutral";return(0,M.tZ)(Yt.Hw,{children:(0,M.tZ)(Ut,{trendDirection:e,children:(0,d._N)("[sign][delta]",{sign:t>=0?"+":"-",delta:(0,A.rl)(Math.abs(t),2)})})})}if("project"===l)return null;const p=(0,Et.LY)(l),u=r[p];return"integer"===o[p]&&"number"==typeof u&&u>999?(0,M.tZ)($t.u,{title:u.toLocaleString(),containerDisplayMode:"block",position:"right",children:c}):c}(t,r,s,e)}function g(t){const r=o??Vt;return(a,i)=>function(t,r,a){let i="left";i="equation"===r.column.kind?"right":(0,Et.qG)(r.name,r.type,t);const s={field:"equation"===r.column.kind?r.key:r.name,width:r.width},o={};t&&Object.keys(t).forEach((e=>{o[(0,Et.LY)(e)]=t[e]}));const l=e.sortForField(s,o),d=(0,Z.M3)(s,o),c=l?l.kind:void 0;return(0,M.tZ)(Ft.Z,{align:i,title:a||s.field,direction:c,canSort:d,generateSortLink:function(){if(!t)return;const r=e.sortOnField(s,o).generateQueryStringObject();return{...n,query:{...n.query,sort:r.sort}}}})}(t,a,r[i])}function f(t,e){p((n=>n.map(((n,r)=>r===t?Number(e.width??y.z7):n))))}(0,r.useEffect)((()=>{m((t=>{const n=e.clone();return n.query=t.query,n}))}),[e]);const x=e.getColumns().filter((t=>!t.name.startsWith("count_miserable")&&!t.name.startsWith("percentile_range")&&"project_threshold_config"!==t.name&&"project"!==t.name&&"http.method"!==t.name&&"total.transaction_duration"!==t.name&&"sum(transaction.duration)"!==t.name)).map(((t,e)=>"number"==typeof c[e]?{...t,width:c[e]}:t)),v=e.getSorts();return(0,M.BX)(Nt.Z,{target:"performance_table",position:"top-start",children:[(0,M.tZ)(It,{placeholder:(0,d.t)("Search for endpoints"),onSearch:function(t){const n=e.clone();n.query+=`transaction:*${t}*`,m(n)}}),(0,M.tZ)(yt.Z,{eventView:u,orgSlug:i.slug,location:n,setError:t=>s(t?.message),referrer:"api.starfish.endpoint-list",queryExtras:{dataset:l??"metrics"},children:t=>{let{pageLinks:e,isLoading:a,tableData:i}=t;return(0,M.BX)(r.Fragment,{children:[(0,M.tZ)(y.ZP,{isLoading:a,data:i?i.data:[],columnOrder:x,columnSortBy:v,grid:{onResizeColumn:f,renderHeadCell:g(i?.meta),renderBodyCell:h(i)},location:n}),(0,M.tZ)(wt.Z,{pageLinks:e})]})}})]})}Mt.displayName="EndpointList";const Wt=Mt,Ut=(0,T.Z)("div",{target:"e152i1y81"})("color:",(t=>"good"===t.trendDirection?t.theme.successText:"bad"===t.trendDirection?t.theme.errorText:t.theme.subText),";float:right;"),It=(0,T.Z)(Xt.Z,{target:"e152i1y80"})("margin-bottom:",(0,P.D)(2),";"),Gt=(0,X.Z)($.Z);function Qt(t){const{organization:e,eventView:n,onSelect:a}=t,i=(0,B.u)(),[s,o]=(0,r.useState)(null),l=(0,pt.Z)(),{selection:c}=l,{projects:p,environments:u}=c;return(0,ct.WE)([`/organizations/${e.slug}/events-starfish/`,{query:{environment:u,project:p.map((t=>String(t))),statsPeriod:"7d"}}],{staleTime:10}),(0,M.BX)("div",{"data-test-id":"starfish-view",children:[(0,M.tZ)(Kt,{minSize:200,children:(0,M.BX)(Ht,{children:[(0,M.tZ)(Jt,{children:(0,M.tZ)(Y.Z,{title:(0,d.t)("Where is time spent in my web service?")})}),(0,M.BX)(te,{children:[(0,M.tZ)(ut.Z,{title:(0,d.t)("Error Rate"),children:function(){const t=new b.MY(["event.type:transaction"]);return(0,M.tZ)(Gt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:n.environment,project:n.project,period:n.statsPeriod,referrer:"starfish-homepage-failure-rate",start:n.start,end:n.end,organization:e,yAxis:"equation|count_if(http.status_code,greaterOrEquals,500)/(count_if(http.status_code,equals,200)+count_if(http.status_code,greaterOrEquals,500))",children:t=>{const e=t.timeseriesData?.map((t=>({data:t.data,seriesName:(0,d.t)("Failure Rate"),color:et.$[5][3],silent:!0})));return e?(function(t,e){const{data:n}=t[0],r=function(t,e,n){const r=e-t,a=Math.round(r/40),i=[];let s=t;for(;s<e;){const t=[s,s+a-0];i.push(t),s+=a}return i}(n[0].name,n[n.length-1].name).map((t=>{let[e,n]=t;return[{name:"start",xAxis:e,emphasis:{disabled:!1}},{name:"end",xAxis:n,emphasis:{disabled:!1}}]}));t.push({seriesName:"Clickable Area",color:e,data:[],silent:!1,emphasis:{disabled:!1},markArea:(0,mt.Z)({silent:!1,itemStyle:{color:e,opacity:0},label:{show:!1},emphasis:{disabled:!1,itemStyle:{opacity:.2}},data:r})})}(e,i.red300),(0,M.BX)(r.Fragment,{children:[(0,M.tZ)(Ct,{onClose:()=>o(null),chartData:e,spike:s}),(0,M.tZ)(dt,{statsPeriod:n.statsPeriod,height:145,data:e,start:n.start,end:n.end,loading:t.loading,utc:!1,grid:{left:"0",right:"0",top:"16px",bottom:"8px"},definedAxisTicks:2,handleSpikeAreaClick:t=>{"markArea"===t.componentType&&o({startTimestamp:t.data.coord[0][0],endTimestamp:t.data.coord[1][0]})}})]})):null}})}()}),(0,M.tZ)(ut.Z,{title:(0,d.t)("Throughput"),children:function(){const t=new b.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,M.tZ)(Gt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:"1h",includeTransformedData:!0,limit:1,environment:n.environment,project:n.project,period:n.statsPeriod,referrer:"starfish-homepage-count",start:n.start,end:n.end,organization:e,yAxis:"tpm()",queryExtras:{dataset:"metrics"},children:t=>{let{loading:e,timeseriesData:n}=t;const r=n?.map((t=>({data:t.data,seriesName:(0,d.t)("Throughput"),color:et.$[0][0]})));return r?(0,M.tZ)(V.Z,{statsPeriod:"24h",height:145,data:r,start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:4,stacked:!0,isLineChart:!0,chartColors:i.charts.getColorPalette(2),disableXAxis:!0}):null}})}()})]})]})}),(0,M.tZ)(Wt,{...t,setError:(0,L.De)().setPageError,dataset:"discover",onSelect:a,columnTitles:["endpoint","tpm","p50(duration)","p50 change","failure count","cumulative time"]})]})}Qt.displayName="StarfishView";const Kt=(0,T.Z)(tt.c,{target:"epbipxo3"})("margin-bottom:",(0,P.D)(2),";"),Ht=(0,T.Z)("div",{target:"epbipxo2"})("display:flex;flex-direction:row;flex-wrap:wrap;gap:",(0,P.D)(2),";"),Jt=(0,T.Z)("div",{target:"epbipxo1"})({name:"1xy7mri",styles:"flex:1.5"}),te=(0,T.Z)("div",{target:"epbipxo0"})({name:"82a6rk",styles:"flex:1"});function ee(t){const e=(0,M.BX)(j.Z,{condensed:!0,children:[(0,M.tZ)(C.Z,{}),(0,M.tZ)(E.Z,{alignDropdown:"left"})]}),[n,a]=(0,r.useState)({selectedRow:void 0}),{selectedRow:i}=n;return(0,M.tZ)(D.T3,{children:(0,M.BX)(L.V_,{children:[(0,M.tZ)(D.h4,{children:(0,M.tZ)(D.oB,{children:(0,M.tZ)(D.Dx,{children:(0,d.t)("Starfish")})})}),(0,M.tZ)(D.uT,{children:(0,M.BX)(D.or,{fullWidth:!0,children:[(0,M.tZ)(L.YY,{}),(0,M.BX)(r.Fragment,{children:[(0,M.tZ)(ne,{children:e}),(0,M.tZ)(Qt,{...t,onSelect:t=>a({selectedRow:t})}),(0,M.tZ)(U,{row:i,onClose:()=>a({selectedRow:void 0}),eventView:t.eventView,organization:t.organization,location:t.location})]})]})})]})})}ee.displayName="StarfishLanding";const ne=(0,T.Z)("div",{target:"e160gsn70"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,P.D)(2),";margin-bottom:",(0,P.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}");function re(t){let{selection:e,location:n,router:a}=t;const g=(0,p.Z)(),f=(0,u.Z)(),{projects:T}=(0,h.Z)(),E=(0,r.useRef)(!1),D=(0,m.Z)(e.datetime),j=(0,c.gp)(f),C=function(t,e){let{withStaticFilters:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;const{query:a}=t,i=a.start&&a.end,s=(0,_.ie)({start:(0,w.ro)(a.start),end:(0,w.ro)(a.end),statsPeriod:a.statsPeriod||i?(0,w.ro)(a.statsPeriod):S(r)}),o=`equation|(percentile_range(transaction.duration,0.50,lessOrEquals,${s})-percentile_range(transaction.duration,0.50,greater,${s}))/percentile_range(transaction.duration,0.50,lessOrEquals,${s})`;let l=(0,w.ro)(a.sort,`-${q}`);const c=l.startsWith("-");x()(l,"-").startsWith("equation|(percentile_range(transaction.duration,0.50,lessOrEquals,")&&(l=c?`-${o}`:o);const p=["transaction","http.method","tpm()","p50()",o,"count_if(http.status_code,greaterOrEquals,500)",q,"total.transaction_duration","sum(transaction.duration)",`percentile_range(transaction.duration,0.50,lessOrEquals,${s})`,`percentile_range(transaction.duration,0.50,greater,${s})`],u={id:void 0,name:(0,d.t)("Performance"),query:"event.type:transaction has:http.method transaction.op:http.server",projects:[],fields:p,version:2},m=Array(u.fields.length).fill(y.z7);m[u.fields.length-1]="110",u.widths=m,a.statsPeriod||i||(u.range=S(r)),u.orderby=l;const h=(0,w.ro)(a.query,"");return u.query=`${u.query} ${function(t,e){const n=new b.MY(t);if(n.freeText.length>0){const t=n.freeText.join(" ");n.setFilterValues("transaction",[(0,v.D)(t)],!1),n.freeText=[]}return e&&(n.tokens=n.tokens.filter((t=>t.key&&k.includes(t.key)))),n.formatString()}(h,n)}`,Z.ZP.fromNewQueryWithLocation(u,t)}(n,T,{withStaticFilters:j},f);return(0,r.useEffect)((()=>{if(!E.current)return(0,s.QK)(g,f.slug,e),void(E.current=!0);i()(D,e.datetime)||(0,s.QK)(g,f.slug,e)}),[e.datetime,D,e,g,f,n,T]),(0,M.tZ)(l.Z,{title:(0,d.t)("Starfish"),orgSlug:f.slug,children:(0,M.tZ)(o.Z,{defaultSelection:{datetime:{start:null,end:null,utc:!1,period:S(f)}},children:(0,M.tZ)(ee,{router:a,eventView:C,organization:f,location:n,projects:T,selection:e,withStaticFilters:j})})})}re.displayName="WebServiceView";const ae=(0,g.Z)(re)}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_webServiceView_index_tsx.3a1e22e9f242ddeba979078c44caa8fd.js.map