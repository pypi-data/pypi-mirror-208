(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_performanceDuration_tsx-app_utils_discover_charts_tsx-app_views_performance_tr-4693fa","app_utils_discover_charts_tsx-app_views_starfish_components_sparkline_tsx-app_views_starfish_-b3e740","app_views_starfish_modules_APIModule_endpointTable_tsx"],{"./app/components/performanceDuration.tsx":(t,e,s)=>{"use strict";s.d(e,{Z:()=>o});var n=s("./app/components/duration.tsx"),a=s("./app/utils.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(t){const e=function(t){return(0,a.ri)(t.nanoseconds)}(t)?t.nanoseconds/1e9:function(t){return(0,a.ri)(t.milliseconds)}(t)?t.milliseconds/1e3:t.seconds;return(0,r.tZ)(n.Z,{abbreviation:t.abbreviation,seconds:e,fixedDigits:2})}i.displayName="PerformanceDuration";const o=i},"./app/utils/discover/charts.tsx":(t,e,s)=>{"use strict";s.d(e,{CX:()=>i,Xp:()=>l,gu:()=>o,x1:()=>u});var n=s("./app/locale.tsx"),a=s("./app/utils.tsx"),r=s("./app/utils/formatters.tsx");function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";return(0,a.ri)(t)?function(t,e){if(!(0,a.ri)(t))return"—";switch(e){case"integer":case"number":return t.toLocaleString();case"percentage":return(0,r.rl)(t,2);case"duration":return(0,r.g9)(t/1e3,2,!0);case"size":return(0,a.F)(t);default:return t.toString()}}(t,e):"—"}function o(t,e){return u(t,e,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3?arguments[3]:void 0)}function u(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;switch(e){case"integer":case"number":return s?(0,r.Du)(t):t.toLocaleString();case"percentage":return(0,r.rl)(t,0);case"duration":return function(t,e){if(e??=c(t),0===t)return"0";switch(e){case r.ps:{const e=(t/r.ps).toFixed(0);return(0,n.t)("%swk",e)}case r.x4:{const e=(t/r.x4).toFixed(0);return(0,n.t)("%sd",e)}case r.kr:{const e=(t/r.kr).toFixed(0);return(0,n.t)("%shr",e)}case r.EB:{const e=(t/r.EB).toFixed(0);return(0,n.t)("%smin",e)}case r.sh:{const e=(t/r.sh).toFixed(0);return(0,n.t)("%ss",e)}default:const e=t.toFixed(0);return(0,n.t)("%sms",e)}}(t,i);case"size":return(0,a.F)(t,0);default:return t.toString()}}function l(t,e){let s=0;const n=function(t,e){let s;if(t[0]?.data){let n,a=t[0];t.forEach(((s,r)=>{let{seriesName:i,data:o}=s;!1!==e?.selected?.[i]&&o.length&&(a=t[r],n??=t[r])})),n?.data&&(s={max:Math.max(...n.data.map((t=>{let{value:e}=t;return e})).filter((t=>!!t))),min:Math.min(...a.data.map((t=>{let{value:e}=t;return e})).filter((t=>!!t)))})}return s}(t,e);if(n){const t=(n.max+n.min)/2;s=c((n.max-n.min)/5),(t/s).toFixed(0).length>6&&(s=c(t))}return s}function c(t){return t>=r.ps?r.ps:t>=r.x4?r.x4:t>=r.kr?r.kr:t>=r.EB?r.EB:t>=r.sh?r.sh:1}},"./app/utils/discover/genericDiscoverQuery.tsx":(t,e,s)=>{"use strict";s.d(e,{AA:()=>v,JC:()=>w,ZP:()=>E,o:()=>m});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),r=s("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),i=s("./app/api.tsx"),o=s("./app/locale.tsx"),u=s("./app/utils/discover/eventView.tsx"),l=s("./app/utils/performance/contexts/performanceEventViewContext.tsx"),c=s("./app/views/organizationContext.tsx"),d=s("./app/utils/useApi.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m{constructor(t,e){(0,n.Z)(this,"message",void 0),(0,n.Z)(this,"originalError",void 0),this.message=t,this.originalError=e}getOriginalError(){return this.originalError}}class h extends a.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null,api:new i.KU}),(0,n.Z)(this,"_shouldRefetchData",(t=>{const e=x(this.props),s=x(t);return!(0,u.ze)(e,s)||t.limit!==this.props.limit||t.route!==this.props.route||t.cursor!==this.props.cursor})),(0,n.Z)(this,"_parseError",(t=>{if(this.props.parseError)return this.props.parseError(t);if(!t)return null;const e=t.responseJSON?.detail;if("string"==typeof e)return new m(e,t);const s=e?.message;return new m("string"==typeof s?s:(0,o.t)("An unknown error occurred."),t)})),(0,n.Z)(this,"fetchData",(async()=>{const{queryBatching:t,beforeFetch:e,afterFetch:s,didFetch:n,eventView:a,orgSlug:r,route:i,setError:o}=this.props,{api:u}=this.state;if(!a.isValid())return;const l=`/organizations/${r}/${i}/`,c=Symbol("tableFetchID"),d=x(this.props);this.setState({isLoading:!0,tableFetchID:c}),o?.(void 0),e?.(u),u.clear();try{const[e,,a]=await v(u,l,d,{queryBatching:t});if(this.state.tableFetchID!==c)return;const r=s?s(e,this.props):e;n?.(r),this.setState((t=>({isLoading:!1,tableFetchID:void 0,error:null,pageLinks:a?.getResponseHeader("Link")??t.pageLinks,tableData:r})))}catch(t){const e=this._parseError(t);this.setState({isLoading:!1,tableFetchID:void 0,error:e,tableData:null}),o&&o(e??void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(t){const e=this._shouldRefetchData(t),s=!1===t.eventView.isValid()&&this.props.eventView.isValid(),n=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(t,this.props);(e||s||n)&&this.fetchData()}render(){const{isLoading:t,error:e,tableData:s,pageLinks:n}=this.state,a={isLoading:t,error:e,tableData:s,pageLinks:n},r=this.props.children;return r?.(a)}}function g(t){const e=(0,a.useContext)(c.g)?.slug,s=(0,a.useContext)(l.uL)?.eventView,n=t.orgSlug??e,r=t.eventView??s;if(void 0===n||void 0===r)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const i={...t,orgSlug:n,eventView:r};return(0,p.tZ)(h,{...i})}h.displayName="_GenericDiscoverQuery",g.displayName="GenericDiscoverQuery";const f=200,_=2,y=t=>new Promise((e=>setTimeout(e,t)));async function v(t,e,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{queryBatching:a,retry:r}=n;if(a?.batchRequest)return a.batchRequest(t,e,{query:s,includeAllArgs:!0});const i=r?.baseTimeout??f,o=r?.timeoutMultiplier??_,u=r?.statusCodes??[],l=r?.tries??1;let c,d=0,p=0;for(;d<l&&(!c||u.includes(c.status));){p>0&&await y(p);try{return d++,await t.requestPromise(e,{method:"GET",includeAllArgs:!0,query:{...s}})}catch(t){c=t,p=i*o**(d-1)}}throw c}function x(t){const{cursor:e,limit:s,noPagination:n,referrer:a,getRequestPayload:r,eventView:i,location:o,forceAppendRawQueryString:u}=t,l=r?r(t):i.getEventsAPIPayload(o,u);return e&&(l.cursor=e),s&&(l.per_page=s),n&&(l.noPagination=n),a&&(l.referrer=a),Object.assign(l,t.queryExtras??{}),l}function w(t){const e=(0,d.Z)(),{orgSlug:s,route:n}=t,a=`/organizations/${s}/${n}/`,i=x(t);return(0,r.a)([n,i],(async()=>{const[s]=await v(e,a,i,{queryBatching:t.queryBatching});return s}))}const E=g},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(t,e,s)=>{"use strict";s.d(e,{bq:()=>a,uL:()=>i});var n=s("./app/utils/performance/contexts/utils.tsx");const[a,r,i]=(0,n.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(t,e,s)=>{"use strict";s.d(e,{n:()=>a}),s("../node_modules/core-js/modules/es.error.cause.js");var n=s("../node_modules/react/index.js");function a(t){const{strict:e=!0,errorMessage:s=`useContext for "${t.name}" must be inside a Provider with a value`,name:a}=t,r=(0,n.createContext)(void 0);return r.displayName=a,[r.Provider,function(){const t=(0,n.useContext)(r);if(!t&&e)throw new Error(s);return t},r]}},"./app/views/performance/transactionSummary/transactionTags/utils.tsx":(t,e,s)=>{"use strict";s.d(e,{Zn:()=>r,bZ:()=>i,oT:()=>l,oc:()=>u,vG:()=>o});var n=s("./app/utils/analytics.tsx"),a=s("./app/utils/queryString.tsx");function r(t){return(0,a.ro)(t.query.tagKey)}function i(t){(0,n.Gi)("performance_views.tags.interaction",{organization:t})}function o(t){let{orgSlug:e,transaction:s,projectID:n,query:a}=t;const r=function(t){let{orgSlug:e}=t;return`/organizations/${e}/performance/summary/tags/`}({orgSlug:e});return{pathname:r,query:{transaction:s,project:n,environment:a.environment,statsPeriod:a.statsPeriod,start:a.start,end:a.end,query:a.query,tagKey:a.tagKey}}}function u(t){let e=(0,a.ro)(t.query?.tagSort)??"-frequency";return["sumdelta"].find((t=>e?.includes(t)))&&(e="-frequency"),e}function l(t){const e=Object.keys(t).find((t=>t.includes("histogram")));if(!e)return;const s=e.split("_");return{histogramField:e,bucketSize:parseInt(s[s.length-3],10),offset:parseInt(s[s.length-2],10),multiplier:parseInt(s[s.length-1],10)}}},"./app/views/starfish/components/sparkline.tsx":(t,e,s)=>{"use strict";s.d(e,{K:()=>d,Z:()=>c});var n=s("../node_modules/echarts/lib/chart/line/install.js"),a=s("../node_modules/echarts/lib/extension.js"),r=s("../node_modules/echarts/core.js"),i=s("../node_modules/zrender/lib/svg/Painter.js");function o(t){t.registerPainter("svg",i.Z)}var u=s("../node_modules/echarts-for-react/lib/core.js"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function c(t){let{series:e,width:s,color:i}=t;if(a.D([n.N,o]),!e.data)return null;const c={data:e.data.map((t=>t.value)),type:"line",showSymbol:!1,smooth:!0};return(0,l.tZ)(u.Z,{echarts:r,option:{color:i,series:[c],xAxis:{show:!1,data:e.data.map((t=>t.name)),type:"category"},yAxis:{show:!1,type:"value"},grid:{left:3,top:3,right:3,bottom:3}},notMerge:!0,style:{height:25,width:s??200},lazyUpdate:!0,theme:"theme_name"})}function d(t){let{series:e,markLine:s,width:i,height:c,color:d}=t;function p(t,e){return{data:t.data.map((t=>t.value)),type:"line",showSymbol:!1,smooth:!0,lineStyle:{color:d[e],width:[1,2][e]},yAxisIndex:e}}return a.D([n.N,o]),(0,l.tZ)(u.Z,{echarts:r,option:{series:[...e.map(((t,e)=>p(t,e))),s],xAxis:{show:!1,data:p(e[0],0).data.map((t=>t.name)),type:"category"},yAxis:[{show:!1,type:"value"},{show:!1,type:"value"}],grid:{left:3,top:3,right:3,bottom:3}},notMerge:!0,style:{height:c??25,width:i??200},lazyUpdate:!0,theme:"theme_name"})}c.displayName="Sparkline",d.displayName="MultiSparkline"},"./app/views/starfish/modules/APIModule/endpointTable.tsx":(t,e,s)=>{"use strict";s.d(e,{Dq:()=>E,WJ:()=>v,ZP:()=>y,_F:()=>w,xe:()=>D});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs")),r=s("../node_modules/moment/moment.js"),i=s.n(r),o=s("./app/components/duration.tsx"),u=s("./app/components/gridEditable/index.tsx"),l=s("./app/components/links/link.tsx"),c=s("./app/constants/chartPalette.tsx"),d=s("./app/views/starfish/components/sparkline.tsx"),p=s("./app/views/starfish/utils/constants.tsx"),m=s("./app/views/starfish/utils/useSpansQuery.tsx"),h=s("./app/views/starfish/utils/zeroFillSeries.tsx"),g=s("./app/views/starfish/modules/APIModule/queries.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _=[{key:"description",name:"URL",width:600},{key:"throughput",name:"throughput",width:200},{key:"p50_trend",name:"p50 Trend",width:200},{key:"p50(span.self_time)",name:"p50",width:u.z7},{key:"count_unique(user)",name:"Users",width:u.z7},{key:"count_unique(transaction)",name:"Transactions",width:u.z7},{key:"sum(span.self_time)",name:"Total Time",width:u.z7}];function y(t){let{location:e,onSelect:s,filterOptions:n,columns:r}=t;const{isLoading:o,data:l}=(0,m.bB)({queryString:(0,g.an)(n),eventView:(0,g.g9)(n),initialData:[]}),{isLoading:c,data:d}=(0,a.a)({queryKey:["endpointAggregates",n],queryFn:()=>fetch(`${p.M}/?query=${(0,g.jD)(n)}`).then((t=>t.json())),retry:!1,initialData:[]}),y={};d.forEach((t=>{let{description:e,interval:s,count:n,p50:a}=t;e in y?y[e].push({name:s,count:n,p50:a}):y[e]=[{name:s,count:n,p50:a}]}));const w=l.map((t=>{const e=t.description,s={seriesName:"throughput",data:y[e]?.map((t=>{let{name:e,count:s}=t;return{name:e,value:s}}))},n={seriesName:"p50 Trend",data:y[e]?.map((t=>{let{name:e,p50:s}=t;return{name:e,value:s}}))},a=(0,h.b)(s,i().duration(12,"hours")),r=(0,h.b)(n,i().duration(12,"hours"));return{...t,throughput:a,p50_trend:r}}));return(0,f.tZ)(u.ZP,{isLoading:o||c,data:w,columnOrder:r??_,columnSortBy:[],grid:{renderHeadCell:v,renderBodyCell:(t,e)=>x(t,e,s)},location:e})}function v(t){return"throughput"===t.key||"p50_trend"===t.key?(0,f.tZ)(D,{children:(0,f.tZ)(w,{children:t.name})}):t.key.toString().match(/^p\d\d/)||!["description","transaction"].includes(t.key.toString())?(0,f.tZ)(E,{children:(0,f.tZ)(w,{children:t.name})}):(0,f.tZ)(w,{children:t.name})}function x(t,e,s){if("description"===t.key&&s)return(0,f.tZ)(w,{children:(0,f.tZ)(l.Z,{onClick:()=>s(e),to:"",children:e[t.key]})});if("throughput"===t.key)return(0,f.tZ)(d.Z,{color:c.$[3][0],series:e[t.key],width:t.width?t.width-t.width/5:void 0});if("p50_trend"===t.key)return(0,f.tZ)(d.Z,{color:c.$[3][3],series:e[t.key],width:t.width?t.width-t.width/5:void 0});let n=null;return n=t.key.toString().match(/^p\d\d/)||"sum(span.self_time)"===t.key?(0,f.tZ)(o.Z,{seconds:e[t.key]/1e3,fixedDigits:2,abbreviation:!0}):(["description","transaction"].includes(t.key.toString()),(0,f.tZ)(w,{children:e[t.key]})),t.key.toString().match(/^p\d\d/)||t.key.toString().match(/^.*\(.*\)/)?(0,f.tZ)(E,{children:n}):(0,f.tZ)(D,{children:n})}y.displayName="EndpointTable",v.displayName="renderHeadCell",x.displayName="renderBodyCell";const w=(0,n.Z)("span",{target:"e6m90oa2"})({name:"12wal98",styles:"text-overflow:ellipsis;overflow:hidden;white-space:nowrap"}),E=(0,n.Z)("span",{target:"e6m90oa1"})({name:"evqzij",styles:"text-align:right;width:100%"}),D=(0,n.Z)("span",{target:"e6m90oa0"})({name:"zq26zb",styles:"text-align:left;width:100%"})},"./app/views/starfish/modules/APIModule/queries.tsx":(t,e,s)=>{"use strict";s.d(e,{Ao:()=>d,J5:()=>f,O6:()=>i,Rj:()=>v,S4:()=>c,YK:()=>p,Z$:()=>_,Zn:()=>h,an:()=>u,eL:()=>x,g9:()=>l,hB:()=>o,jD:()=>w,o_:()=>g,tC:()=>y,xI:()=>m});var n=s("./app/utils/discover/eventView.tsx"),a=s("./app/utils/discover/types.tsx"),r=s("./app/views/starfish/utils/dates.tsx");const i=t=>{let{datetime:e}=t;const{start_timestamp:s,end_timestamp:n}=(0,r.SW)(e);return`SELECT\n    domain,\n    toStartOfInterval(start_timestamp, INTERVAL 12 HOUR) as interval,\n    quantile(0.99)(exclusive_time) as p99,\n    count() as count,\n    countIf(greaterOrEquals(status, 400) AND lessOrEquals(status, 599)) as failure_count,\n    failure_count / count as failure_rate\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    AND domain != ''\n    ${s?`AND greaterOrEquals(start_timestamp, '${s}')`:""}\n    ${n?`AND lessOrEquals(start_timestamp, '${n}')`:""}\n    GROUP BY domain, interval\n    ORDER BY domain, interval asc\n `},o=t=>{let{datetime:e}=t;return n.ZP.fromSavedQuery({name:"",fields:["domain"],yAxis:["p99(span.self_time)","count()"],query:"module:http",topEvents:"10",start:e.start,end:e.end,range:e.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},u=t=>{let{domain:e,action:s,datetime:n,transaction:a}=t;const{start_timestamp:i,end_timestamp:o}=(0,r.SW)(n);return`SELECT\n    description,\n    group_id,\n    domain,\n    action,\n    quantile(0.5)(exclusive_time) AS "p50(span.self_time)",\n    quantile(0.95)(exclusive_time) AS "p95(span.self_time)",\n    sum(exclusive_time) AS "sum(span.self_time)",\n    uniq(user) AS "count_unique(user)", uniq(transaction) AS "count_unique(transaction)",\n    count() AS count,\n    countIf(greaterOrEquals(status, 400) AND lessOrEquals(status, 599)) AS failure_count,\n    failure_count / count AS failure_rate\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    ${e?`AND domain = '${e}'`:""}\n    ${s?`AND action = '${s}'`:""}\n    ${a?`AND transaction = '${a}'`:""}\n    ${i?`AND greaterOrEquals(start_timestamp, '${i}')`:""}\n    ${o?`AND lessOrEquals(start_timestamp, '${o}')`:""}\n    GROUP BY description, domain, action, group_id\n    ORDER BY count DESC\n    LIMIT 10\n  `},l=t=>{let{domain:e,action:s,datetime:r,transaction:i}=t;return n.ZP.fromSavedQuery({name:"",fields:["description","group_id","domain","action","p50(span.self_time)","p95(span.self_time)","sum(span.self_time)","count()","count_unique(user)","count_unique(transaction)"],orderby:"-count",query:`module:http ${e?`domain:${e}`:""} ${s?`action:${s}`:""} ${i?`transaction:${i}`:""}`,start:r.start,end:r.end,range:r.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},c=t=>{let{datetime:e}=t;const{start_timestamp:s,end_timestamp:n}=(0,r.SW)(e);return`SELECT domain, count(),\n    sum(exclusive_time) as "sum(span.self_time)",\n    max(exclusive_time) as "p100(span.self_time)",\n    quantile(0.99)(exclusive_time) as "p99(span.self_time)",\n    quantile(0.95)(exclusive_time) as "p95(span.self_time)",\n    quantile(0.50)(exclusive_time) as "p50(span.self_time)"\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    ${s?`AND greaterOrEquals(start_timestamp, '${s}')`:""}\n    ${n?`AND lessOrEquals(start_timestamp, '${n}')`:""}\n    GROUP BY domain\n    ORDER BY count() DESC\n  `},d=t=>{let{datetime:e}=t;return n.ZP.fromSavedQuery({name:"",fields:["domain","count()","sum(span.self_time)","p100(span.self_time)","p99(span.self_time)","p95(span.self_time)","p50(span.self_time)"],orderby:"-count",query:"module:http",start:e.start,end:e.end,range:e.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},p=t=>{let{datetime:e}=t;const{start_timestamp:s,end_timestamp:n}=(0,r.SW)(e);return`SELECT\n    toStartOfInterval(start_timestamp, INTERVAL 12 HOUR) as interval,\n    quantile(0.5)(exclusive_time) as "p50(span.self_time)",\n    quantile(0.75)(exclusive_time) as "p75(span.self_time)",\n    quantile(0.95)(exclusive_time) as "p95(span.self_time)",\n    quantile(0.99)(exclusive_time) as "p99(span.self_time)",\n    count() as "count()",\n    countIf(greaterOrEquals(status, 400) AND lessOrEquals(status, 599)) as "failure_count()",\n    "failure_count()" / "count()" as "failure_rate()"\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    ${s?`AND greaterOrEquals(start_timestamp, '${s}')`:""}\n    ${n?`AND lessOrEquals(start_timestamp, '${n}')`:""}\n    GROUP BY interval\n    ORDER BY interval asc\n `},m=t=>{let{datetime:e}=t;return n.ZP.fromSavedQuery({name:"",fields:["count()","p50(span.self_time)","p75(span.self_time)","p95(span.self_time)","p99(span.self_time)"],yAxis:["count()","p50(span.self_time)","p75(span.self_time)","p95(span.self_time)","p99(span.self_time)"],query:"module:http",start:e.start,end:e.end,range:e.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},h=t=>{let{description:e,transactionName:s,datetime:n,groupId:a}=t;const{start_timestamp:i,end_timestamp:o}=(0,r.SW)(n);return`SELECT\n     toStartOfInterval(start_timestamp, INTERVAL 12 HOUR) as interval,\n     quantile(0.5)(exclusive_time) as p50,\n     quantile(0.95)(exclusive_time) as p95,\n     count() as count,\n     countIf(greaterOrEquals(status, 400) AND lessOrEquals(status, 599)) as failure_count,\n     failure_count / count as failure_rate\n     FROM spans_experimental_starfish\n     WHERE module = 'http'\n     ${e?`AND description = '${e}'`:""}\n     ${a?`AND group_id = '${a}'`:""}\n     ${s?`AND transaction = '${s}'`:""}\n     ${i?`AND greaterOrEquals(start_timestamp, '${i}')`:""}\n     ${o?`AND lessOrEquals(start_timestamp, '${o}')`:""}\n     GROUP BY interval\n     ORDER BY interval asc\n  `},g=t=>{let{description:e,transactionName:s,datetime:n,groupId:a}=t;const{start_timestamp:i,end_timestamp:o}=(0,r.SW)(n);return`\n    SELECT transaction,\n    count(),\n    quantile(0.5)(exclusive_time) as "p50(span.self_time)",\n    quantile(0.95)(exclusive_time) as "p95(span.self_time)",\n    countIf(greaterOrEquals(status, 400) AND lessOrEquals(status, 599)) as failure_count,\n    failure_count / count() as failure_rate,\n    sum(exclusive_time) as "sum(span.self_time)",\n    count(DISTINCT transaction_id) as "count_unique(transaction)"\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    ${e?`AND description = '${e}'`:""}\n    ${a?`AND group_id = '${a}'`:""}\n    ${s?`AND transaction = '${s}'`:""}\n    ${i?`AND greaterOrEquals(start_timestamp, '${i}')`:""}\n    ${o?`AND lessOrEquals(start_timestamp, '${o}')`:""}\n    GROUP BY transaction\n    ORDER BY count() DESC\n    LIMIT 5\n `},f=t=>{let{description:e,transactionName:s,datetime:r,groupId:i}=t;return n.ZP.fromSavedQuery({name:"",fields:["transaction","count()","p50(span.self_time)","p95(span.self_time)","sum(span.self_time)","count_unique(transaction)"],orderby:"-count",query:`module:http ${e?`description:${e}`:""} ${s?`transaction:${s}`:""} ${i?`group_id:${i}`:""}`,start:r.start,end:r.end,range:r.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},_=t=>{let{groupId:e,datetime:s}=t;const{start_timestamp:n,end_timestamp:a}=(0,r.SW)(s);return`\n    SELECT count() AS count, quantile(0.5)(exclusive_time) as p50, span_operation\n    FROM spans_experimental_starfish\n    WHERE group_id = '${e}'\n    ${n?`AND greaterOrEquals(start_timestamp, '${n}')`:""}\n    ${a?`AND lessOrEquals(start_timestamp, '${a}')`:""}\n    GROUP BY span_operation\n `},y=t=>{let{groupId:e,datetime:s}=t;const{start_timestamp:n,end_timestamp:a}=(0,r.SW)(s);return`\n    SELECT transaction, user, domain\n    FROM spans_experimental_starfish\n    WHERE group_id = '${e}'\n    ${n?`AND greaterOrEquals(start_timestamp, '${n}')`:""}\n    ${a?`AND lessOrEquals(start_timestamp, '${a}')`:""}\n `},v=t=>{let{domain:e,datetime:s}=t;const{start_timestamp:n,end_timestamp:a}=(0,r.SW)(s);return`\n    SELECT count() as count, status\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    AND domain = '${e}'\n    ${n?`AND greaterOrEquals(start_timestamp, '${n}')`:""}\n    ${a?`AND lessOrEquals(start_timestamp, '${a}')`:""}\n    GROUP BY status\n    ORDER BY count DESC\n  `},x=t=>{let{domain:e,datetime:s}=t;return n.ZP.fromSavedQuery({name:"",fields:["status","count()"],orderby:"-count",query:`module:http domain:${e}`,start:s.start,end:s.end,range:s.period,dataset:a.as.SPANS_INDEXED,projects:[1],version:2})},w=t=>{let{datetime:e,transaction:s}=t;const{start_timestamp:n,end_timestamp:a}=(0,r.SW)(e);return`\n    SELECT\n    description,\n    toStartOfInterval(start_timestamp, INTERVAL 12 HOUR) as interval,\n    count() AS count,\n    quantile(0.5)(exclusive_time) as p50\n    FROM spans_experimental_starfish\n    WHERE module = 'http'\n    ${s?`AND transaction = '${s}'`:""}\n    ${n?`AND greaterOrEquals(start_timestamp, '${n}')`:""}\n    ${a?`AND lessOrEquals(start_timestamp, '${a}')`:""}\n    GROUP BY description, interval\n    ORDER BY interval asc\n  `}},"./app/views/starfish/utils/constants.tsx":(t,e,s)=>{"use strict";s.d(e,{M:()=>n});const n="http://localhost:8080"},"./app/views/starfish/utils/useSpansQuery.tsx":(t,e,s)=>{"use strict";s.d(e,{bB:()=>h,Y7:()=>f}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.push.js");var n=s("../node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),a=s("../node_modules/moment/moment.js"),r=s.n(a),i=s("./app/utils/discover/discoverQuery.tsx"),o=s("./app/utils/discover/eventView.tsx"),u=s("./app/utils/discover/genericDiscoverQuery.tsx"),l=s("./app/utils/useLocation.tsx"),c=s("./app/utils/useOrganization.tsx"),d=s("./app/views/starfish/utils/constants.tsx"),p=s("../node_modules/react/index.js");const m="YYYY-MM-DDTHH:mm:ss";function h(t){let{eventView:e,queryString:s,initialData:n,forceUseDiscover:a}=t;const{options:r}=function(){const[t,e]=(0,p.useState)({useDiscover:!1});return{options:t,setOptions:e}}(),{useDiscover:i}=r,o=function(t){let{useDiscover:e,isTimeseriesQuery:s}=t;return e?s?f:_:g}({useDiscover:a??i,isTimeseriesQuery:(e?.yAxis?.length??0)>0});if(function(t){return t===_}(o)||function(t){return t===f}(o)){if(e)return o(e,n);throw new Error("eventView argument must be defined when Starfish useDiscover is true")}if(s)return o(s,n);throw new Error("queryString argument must be defined when Starfish useDiscover is false, ie when using scraped data via fetch API")}function g(t,e){const{isLoading:s,data:a}=(0,n.a)({queryKey:[t],queryFn:()=>fetch(`${d.M}/?query=${t}`).then((t=>t.json())),retry:!1,initialData:e});return{isLoading:s,data:a}}function f(t,e){const s=(0,l.T)(),n=(0,c.Z)(),{isLoading:a,data:r}=(0,u.JC)({route:"events-stats",eventView:t,location:s,orgSlug:n.slug,getRequestPayload:()=>({...t.getEventsAPIPayload(s),yAxis:t.yAxis,topEvents:t.topEvents,excludeOther:1,partial:1,orderby:t.sorts?.[0]?(0,o.uZ)(t.sorts?.[0]):void 0,interval:t.interval})});return{isLoading:a,data:a&&e?e:y(r,t)}}function _(t,e){const s=(0,l.T)(),n=(0,c.Z)(),{isLoading:a,data:r}=(0,i._)({eventView:t,orgSlug:n.slug,location:s});return{isLoading:a,data:a&&e?e:r?.data}}function y(t,e){if(!e.yAxis)return[];let s=[];const n=e.yAxis&&("string"==typeof e.yAxis||1===e.yAxis.length),a="string"==typeof e.yAxis?e.yAxis:e.yAxis[0];return t.data?v(t,n?a:"count"):(Object.keys(t).forEach((e=>{t[e].data?s=x(s,v(t[e],n?a:e)):Object.keys(t[e]).forEach((n=>{"order"!==n&&(s=x(s,v(t[e][n],n,e)))}))})),s.map((t=>({...t,interval:r()(1e3*parseInt(t.interval,10)).format(m)}))))}function v(t,e,s){const n=[];return t.data.forEach((t=>{let[a,[{count:r}]]=t;const i=n.find((t=>t.interval===a&&(!s||t.group===s)));i?i[e]=r:n.push({interval:a,[e]:r,group:s})})),n}function x(t,e){const s=JSON.parse(JSON.stringify(t));return e.forEach((t=>{let{interval:e,group:n,...a}=t;const r=s.find((t=>t.interval===e&&(!n||t.group===n)));r?Object.keys(a).forEach((t=>{r[t]=a[t]})):s.push({interval:e,group:n,...a})})),s}},"./app/views/starfish/views/webServiceView/endpointOverview/index.tsx":(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>z});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),i=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),o=s("../node_modules/moment/moment.js"),u=s.n(o),l=s("../node_modules/query-string/index.js"),c=s("./app/components/charts/eventsRequest.tsx"),d=s("./app/components/datePageFilter.tsx"),p=s("./app/components/gridEditable/index.tsx"),m=s("./app/components/layouts/thirds.tsx"),h=s("./app/components/organizations/pageFilterBar.tsx"),g=s("./app/locale.tsx"),f=s("./app/styles/space.tsx"),_=s("./app/utils/discover/eventView.tsx"),y=s("./app/utils/queryClient.tsx"),v=s("./app/utils/tokenizeSearch.tsx"),x=s("./app/utils/useLocation.tsx"),w=s("./app/utils/useOrganization.tsx"),E=s("./app/utils/usePageFilters.tsx"),D=s("./app/utils/withApi.tsx"),S=s("./app/views/starfish/components/breakdownBar.tsx"),q=s("./app/views/starfish/components/chart.tsx"),b=s("./app/components/links/link.tsx"),$=s("./app/components/placeholder.tsx"),Z=s("./app/constants/chartPalette.tsx"),A=s("./app/utils/discover/genericDiscoverQuery.tsx"),k=s("./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx"),O=s("./app/views/starfish/components/sparkline.tsx"),j=s("./app/views/starfish/modules/APIModule/endpointTable.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const R=[{key:"tagKey",name:"Key",width:300},{key:"tagValue",name:"Value",width:200},{key:"p50",name:"p50(duration)",width:200},{key:"throughput",name:"tpm",width:200},{key:"tpmCorrelation",name:"tpm correlation",width:200}];function P(t,e){return{seriesName:t,data:e.map((t=>({name:t[0],value:t[1][0].count})))}}function T(t){let{eventView:e}=t;const s=(0,x.T)(),n=(0,w.Z)(),a=e.clone();a.fields=k.KZ;const r=a.withSorts([{field:"sumdelta",kind:"desc"}]),{isLoading:i,data:o}=(0,A.JC)({route:"events-facets-stats",eventView:e,location:s,orgSlug:n.slug,getRequestPayload:()=>({...r.getEventsAPIPayload(s),aggregateColumn:"transaction.duration"})});if(i)return(0,N.tZ)($.Z,{height:"400px"});const u=[],c=o?.totals,d=Object.keys(c);for(let t=0;t<d.length;t++){const e=d[t];u.push({tagKey:e.split(",")[0],tagValue:e.split(",")[1],throughput:P("throughput",o[e]["count()"].data),p50:P("p50",o[e]["p75(transaction.duration)"].data),tpmCorrelation:(m=c[e].sum_correlation,m>=.8?"very highly correlated":m>=.6?"highly correlated":m>=.4?"correlated":"no/low correlation")})}var m;return(0,N.tZ)(p.ZP,{isLoading:i,data:u,columnOrder:R,columnSortBy:[],location:s,grid:{renderBodyCell:(t,s)=>function(t,s){if("throughput"===t.key||"p50"===t.key)return(0,N.tZ)(O.Z,{color:"throughput"===t.key?Z.$[3][0]:Z.$[3][1],series:s[t.key],width:t.width?t.width-t.width/5:void 0});if("tagValue"===t.key){const n=new v.MY(e.query);let a="";return n.tokens.forEach((t=>{t.key&&(a=a.concat(" ",`${t.key}:${t.value}`))})),a=a.concat(" ",`${s.tagKey}:${s.tagValue}`),(0,N.tZ)(j._F,{children:(0,N.tZ)(b.Z,{to:`/discover/homepage/?${l.stringify({...e.generateQueryStringObject(),query:a,field:["title","p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],yAxis:"count()"})}`,children:s[t.key]})})}return(0,N.tZ)(j.xe,{children:s[t.key]})}(t,s)}})}T.displayName="FacetInsights";var L=s("./app/views/starfish/modules/databaseModule/databaseTableView.tsx"),I=s("./app/views/starfish/modules/databaseModule/queries.ts"),C=s("./app/views/starfish/utils/combineTableDataWithSparklineData.tsx"),B=s("./app/views/starfish/utils/constants.tsx");const F=(0,D.Z)(c.Z),V=[{key:"description",name:"URL",width:400},{key:"throughput",name:"Throughput",width:350},{key:"p50_trend",name:"p50 Trend",width:200},{key:"p50(exclusive_time)",name:"p50",width:p.z7},{key:"transaction_count",name:"Transactions",width:p.z7},{key:"total_exclusive_time",name:"Total Time",width:p.z7}],M=[{key:"description",name:"Query",width:400},{key:"domain",name:"Table",width:100},{key:"throughput",name:"Throughput",width:200},{key:"p75_trend",name:"P75 Trend",width:200},{key:"epm",name:"Tpm",width:p.z7},{key:"p75",name:"p75",width:p.z7},{key:"total_time",name:"Total Time",width:p.z7}];function z(){const t=(0,x.T)(),e=(0,w.Z)(),s=(0,i.u)(),{endpoint:n,method:o,statsPeriod:c}=t.query,p=(0,E.Z)(),{isLoading:f,data:D,isRefetching:b}=(0,I.$R)({}),{data:$}=(0,y.aM)({queryKey:["dbAggregates"],queryFn:()=>fetch(`${B.M}/?query=${(0,I.uU)({datetime:p.selection.datetime,transaction:n})}`).then((t=>t.json())),retry:!1,initialData:[]}),Z={};$.forEach((t=>{let{description:e,interval:s,count:n,p75:a}=t;e in Z?Z[e].push({name:s,count:n,p75:a}):Z[e]=[{name:s,count:n,p75:a}]}));const A=(0,C.Z)(D,$,u().duration(12,"hours")),k=new v.MY(["has:http.method","transaction.op:http.server",`transaction:${n}`,`http.method:${o}`]),O={id:void 0,name:(0,g.t)("Endpoint Overview"),query:k.formatString(),projects:[],fields:[],version:2},R=_.ZP.fromNewQueryWithLocation(O,t);return(0,N.BX)(m.T3,{children:[(0,N.tZ)(m.h4,{children:(0,N.tZ)(m.oB,{children:(0,N.tZ)(m.Dx,{children:(0,g.t)("Endpoint Overview")})})}),(0,N.BX)(m.uT,{children:[(0,N.tZ)(U,{children:(0,N.tZ)(h.Z,{condensed:!0,children:(0,N.tZ)(d.Z,{alignDropdown:"left"})})}),(0,N.BX)(m.or,{fullWidth:!0,children:[(0,N.tZ)(Y,{children:(0,g.t)("Endpoint URL")}),(0,N.tZ)("pre",{children:`${o} ${n}`}),(0,N.tZ)(F,{query:k.formatString(),includePrevious:!1,partial:!0,limit:5,interval:"1h",includeTransformedData:!0,environment:R.environment,project:R.project,period:p.selection.datetime.period,referrer:"starfish-endpoint-overview",start:p.selection.datetime.start,end:p.selection.datetime.end,organization:e,yAxis:["tpm()","p50(transaction.duration)"],queryExtras:{dataset:"metrics"},children:t=>{let{results:e,loading:n}=t;return(0,N.tZ)(a.Fragment,{children:(0,N.BX)(W,{children:[(0,N.BX)(Q,{children:[(0,N.tZ)(Y,{children:(0,g.t)("Throughput")}),(0,N.tZ)(q.Z,{statsPeriod:c??"24h",height:150,data:e?.[0]?[e?.[0]]:[],start:"",end:"",loading:n,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[s.charts.getColorPalette(0)[0]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]}),(0,N.BX)(Q,{children:[(0,N.tZ)(Y,{children:(0,g.t)("p50(duration)")}),(0,N.tZ)(q.Z,{statsPeriod:c??"24h",height:150,data:e?.[1]?[e?.[1]]:[],start:"",end:"",loading:n,utc:!1,stacked:!0,isLineChart:!0,disableXAxis:!0,hideYAxisSplitLine:!0,chartColors:[s.charts.getColorPalette(0)[1]],grid:{left:"0",right:"0",top:"8px",bottom:"16px"}})]})]})})}}),(0,N.tZ)(S.Z,{title:(0,g.t)("Where is time spent in this endpoint?"),transaction:n}),(0,N.tZ)(Y,{children:(0,g.t)("Correlations")}),(0,N.tZ)(T,{eventView:R}),(0,N.tZ)(Y,{children:(0,g.t)("HTTP Spans")}),(0,N.tZ)(j.ZP,{location:t,onSelect:t=>{r.browserHistory.push(`/starfish/span/${encodeURIComponent(t.group_id)}/?${l.stringify({transaction:n})}`)},columns:V,filterOptions:{action:"",domain:"",transaction:n??"",datetime:p.selection.datetime}}),(0,N.tZ)(Y,{children:(0,g.t)("Database Spans")}),(0,N.tZ)(L.Z,{location:t,onSelect:t=>{r.browserHistory.push(`/starfish/span/${encodeURIComponent(t.group_id)}/?${l.stringify({transaction:n})}`)},isDataLoading:f||b,data:A,columns:M})]})]})]})}z.displayName="EndpointOverview";const Y=(0,n.Z)("h3",{target:"e1mmy0la3"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeLarge),";margin:0;margin-bottom:",(0,f.D)(1),";"),U=(0,n.Z)("div",{target:"e1mmy0la2"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,f.D)(2),";margin-bottom:",(0,f.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}"),W=(0,n.Z)("div",{target:"e1mmy0la1"})("display:flex;&>div:last-child{padding-right:",(0,f.D)(1),";}"),Q=(0,n.Z)("div",{target:"e1mmy0la0"})("padding-right:",(0,f.D)(4),";flex:1;")},"../node_modules/lodash/negate.js":t=>{t.exports=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}},"../node_modules/lodash/omitBy.js":(t,e,s)=>{var n=s("../node_modules/lodash/_baseIteratee.js"),a=s("../node_modules/lodash/negate.js"),r=s("../node_modules/lodash/pickBy.js");t.exports=function(t,e){return r(t,a(n(e)))}}}]);
//# sourceMappingURL=../sourcemaps/app_components_performanceDuration_tsx-app_utils_discover_charts_tsx-app_views_performance_tr-4693fa.f7b42b53698abbad737446ada5933bbf.js.map