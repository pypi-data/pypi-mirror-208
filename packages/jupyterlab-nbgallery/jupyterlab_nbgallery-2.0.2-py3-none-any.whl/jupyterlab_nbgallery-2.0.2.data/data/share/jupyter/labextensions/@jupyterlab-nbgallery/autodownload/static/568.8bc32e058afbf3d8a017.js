"use strict";(self.webpackChunk_jupyterlab_nbgallery_autodownload=self.webpackChunk_jupyterlab_nbgallery_autodownload||[]).push([[568],{568:(e,o,t)=>{t.r(o),t.d(o,{default:()=>l});var n=t(38),a=t(142),r=t(569),c=t.n(r);const l={id:"@jupyterlab-nbgallery/autodownload",autoStart:!0,requires:[n.ISettingRegistry],activate:async(e,o)=>{let t="",n=0,r=!1;function l(){return a.PageConfig.getBaseUrl()}function s(e,o,t){c().ajax({method:"GET",headers:{Accept:"application/json"},url:e,cache:!1,xhrFields:{withCredentials:!0},success:function(e){!async function(e,o,t){c().ajax({url:l()+"post/"+e+"/"+encodeURIComponent(o)+".ipynb",type:"POST",success:function(){},error:function(e){console.error("Failed upload: "+o)},data:JSON.stringify({type:"notebook",content:JSON.parse(t)})})}(o,t,e)}})}function i(e,o,t){c().ajax({method:"GET",url:l()+"api/contents/"+encodeURIComponent(e),cache:!1,xhrFields:{withCredentials:!0},success:function(e){},error:function(n){console.info("Downloading notebooks to "+e),c().ajax({method:"POST",url:l()+"post/"+encodeURIComponent(e),data:JSON.stringify({type:"directory"}),cache:!1,success:function(n){c().ajax({method:"GET",headers:{Accept:"application/json"},url:o+t,cache:!1,xhrFields:{withCredentials:!0},success:function(t){let n;for(n in t){var a=t[n];s(o+"/notebooks/"+a.uuid+"/download?clickstream=false",e,a.title.replace(/\//g,"⁄"))}}})}})}})}Promise.all([e.restored,o.load("@jupyterlab-nbgallery/autodownload:autodownload")]).then((([,a])=>{try{!function(a){c().ajax({method:"GET",headers:{Accept:"application/json"},url:l()+"jupyterlab_nbgallery/environment",cache:!1,xhrFields:{withCredentials:!0},success:function(c){try{Promise.all([e.restored,o.load("@jupyterlab-nbgallery/environment-registration:environment-registration")]).then((([,e])=>{t=e.get("nbgallery_url").composite}))}catch(e){t=c.NBGALLERY_URL}n=c.NBGALLERY_ENABLE_AUTODOWNLOAD,r=a.get("enabled").composite,console.info("Auto Downloading Notebooks"),(1==n||r)&&(i("Starred",t,"/notebooks/stars"),i("Recently Executed",t,"/notebooks/recently_executed"))}})}(a)}catch(e){console.error(`Problem downloading notebooks \n ${e}`)}}))}}}}]);