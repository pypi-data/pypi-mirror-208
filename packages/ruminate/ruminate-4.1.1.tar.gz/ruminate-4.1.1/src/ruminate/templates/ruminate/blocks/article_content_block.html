{% load static wagtailcore_tags tour_guide_tags wagtail_preference_blocks_tags %}


{% if self.stream_block.meta.container_element %}
<{{ self.stream_block.meta.container_element }}{% if container_styles %} style="{{ container_styles }}"{% endif %}{% if container_classes %} class="{{ container_classes }}"{% endif %}>
{% endif %}

{% for child_block in value %}
{% if child_block.block_type == 'section_begin' %}
{% if child_block.value.anchor_identifier %}
{% define_anchor self.stream_block.anchor_category child_block.value.anchor_identifier level=child_block.value.level|add:"-2" as section_anchor_id %}
{% endif %}
<section {% if child_block.value.anchor_identifier %}id="{{ section_anchor_id }}"{% endif %}>
{% elif child_block.block_type == 'section_end' %}
</section>
{% elif child_block.block_type == 'note' %}
{% if child_block.value.category == 'ruminate:aside' %}
{% include_block_with_hints child_block with anchor_category=self.stream_block.anchor_category %}
{% endif %}
{% else %}
{% include_block_with_hints child_block with anchor_category=self.stream_block.anchor_category %}
{% endif %}
{% endfor %}
{% if self.stream_block.meta.container_element %}
</{{ self.stream_block.meta.container_element }}>
{% endif %}
