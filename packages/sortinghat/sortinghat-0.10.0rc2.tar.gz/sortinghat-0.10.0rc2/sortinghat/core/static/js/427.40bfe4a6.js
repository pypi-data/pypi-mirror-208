"use strict";(self["webpackChunksortinghat_ui"]=self["webpackChunksortinghat_ui"]||[]).push([[427],{2427:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var i=n(457),a=n(5129),r=n(3385),o=n(5223),l=n(4437),s=n(197),d=n(6035),c=n(5144),u=n(6121),m=n(2327),p=n(4284),v=n(2269),g=n(9953),f=n(5294),Z=n(5234),k=n(9664),h=n(3606),x=n(8933),_=(n(8309),function(){var e=this,t=e._self._c;return t(g.Z,[e.individual?t(d.Z,{staticClass:"ml-auto mr-auto mb-8"},[t(f.Z,[t(l.Z,{attrs:{cols:e.showRecommendations?8:12,xl:e.showRecommendations?9:12}},[t(f.Z,{staticClass:"section pa-3 mb-4"},[t(l.Z,[t(p.Z,{staticClass:"pl-1"},[t("avatar",{attrs:{name:e.individual.name,email:e.individual.email}}),t(v.km,[t(v.V9,{staticClass:"font-weight-medium text-h6"},[t("span",[e._v(" "+e._s(e.individual.name||"no name")+" ")]),e.individual.isLocked?e._e():t(u.Z,{attrs:{large:""},on:{save:function(t){return e.updateProfile({name:e.form.name})},cancel:function(t){e.form.name=e.individual.name}},scopedSlots:e._u([{key:"input",fn:function(){return[t(h.Z,{attrs:{label:"Edit name",maxlength:"30","single-line":""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})]},proxy:!0}],null,!1,2518379123)},[t("button",[t(m.Z,{staticClass:"icon--hidden aligned",attrs:{"aria-label":"Edit name",small:""}},[e._v(" mdi-lead-pencil ")])],1)]),t(x.Z,{attrs:{bottom:"",transition:"expand-y-transition","open-delay":"200"},scopedSlots:e._u([{key:"activator",fn:function(n){var i=n.on;return[t(a.Z,e._g({directives:[{name:"show",rawName:"v-show",value:!e.individual.isLocked,expression:"!individual.isLocked"}],staticClass:"aligned focusable",attrs:{icon:"",small:""},on:{click:function(t){return e.updateProfile({isBot:!e.individual.isBot})}}},i),[t(m.Z,{class:{"icon--hidden":!e.individual.isBot},attrs:{small:""}},[e._v(" mdi-robot ")])],1)]}}],null,!1,460410633)},[t("span",[e._v(e._s(e.individual.isBot?"Unmark as bot":"Mark as bot"))])]),t(m.Z,{directives:[{name:"show",rawName:"v-show",value:e.individual.isLocked&&e.individual.isBot,expression:"individual.isLocked && individual.isBot"}],staticClass:"aligned",attrs:{small:"",right:""}},[e._v(" mdi-robot ")])],1),t(v.oZ,[e._v(e._s(e.individual.organization))])],1)],1)],1),t(l.Z,{staticClass:"d-flex justify-end align-center mr-1",attrs:{cols:"2"}},[e.individual.isLocked?t(a.Z,{staticClass:"mr-4",attrs:{text:"",small:"",outlined:""},on:{click:e.unlock}},[t(m.Z,{attrs:{small:"",left:""}},[e._v("mdi-lock-open")]),e._v(" Unlock ")],1):t(a.Z,{staticClass:"mr-4",attrs:{text:"",small:"",outlined:""},on:{click:e.lock}},[t(m.Z,{attrs:{small:"",left:""}},[e._v("mdi-lock")]),e._v(" Lock ")],1),t(a.Z,{attrs:{text:"",small:"",outlined:"",disabled:e.individual.isLocked},on:{click:e.confirmDelete}},[t(m.Z,{attrs:{small:"",left:""}},[e._v("mdi-delete")]),e._v(" Delete ")],1)],1)],1),t(f.Z,{staticClass:"section mb-4"},[t(d.Z,{attrs:{fluid:""}},[t(k.Z,[e._v("Profile")]),t(f.Z,{staticClass:"ml-9"},[t(l.Z,{staticClass:"ml-6",attrs:{cols:"1"}},[e._v(" Email: ")]),t(l.Z,[e.individual.isLocked?t("span",[e._v(e._s(e.individual.email||"none"))]):t(u.Z,{attrs:{large:""},on:{save:function(t){return e.updateProfile({email:e.form.email})},cancel:function(t){e.form.email=e.individual.email}},scopedSlots:e._u([{key:"input",fn:function(){return[t(h.Z,{attrs:{label:"Edit email",maxlength:"30","single-line":""},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})]},proxy:!0}],null,!1,2601091443)},[t("button",[e._v(" "+e._s(e.individual.email||"none")+" "),t(m.Z,{staticClass:"icon--hidden aligned",attrs:{"aria-label":"Edit name",small:""}},[e._v(" mdi-lead-pencil ")])],1)])],1)],1),t(f.Z,{staticClass:"ml-9"},[t(l.Z,{staticClass:"ml-6",attrs:{cols:"1"}},[e._v(" Country: ")]),t(l.Z,[e.individual.isLocked?t("span",[e._v(" "+e._s(e.individual.country?e.individual.country.name:"none")+" ")]):t(u.Z,{attrs:{large:""},on:{save:function(t){return e.updateProfile({countryCode:e.form.country?e.form.country.code:""})},cancel:function(t){e.form.country=e.individual.country}},scopedSlots:e._u([{key:"input",fn:function(){return[t(s.Z,{attrs:{items:e.countries,label:"Country","item-text":"name","single-line":""},on:{"~click":function(t){return e.getCountryList.apply(null,arguments)},"~keypress":function(t){return e.getCountryList.apply(null,arguments)}},model:{value:e.form.country,callback:function(t){e.$set(e.form,"country",t)},expression:"form.country"}})]},proxy:!0}],null,!1,4003329680)},[t("button",[e._v(" "+e._s(e.individual.country?e.individual.country.name:"none")+" "),t(m.Z,{staticClass:"icon--hidden aligned",attrs:{"aria-label":"Edit country",small:""}},[e._v(" mdi-lead-pencil ")])],1)])],1)],1),t(f.Z,{staticClass:"ml-9"},[t(l.Z,{staticClass:"ml-6",attrs:{cols:"1"}},[e._v(" Gender: ")]),t(l.Z,[e.individual.isLocked?t("span",[e._v(" "+e._s(e.individual.gender||"none")+" ")]):t(u.Z,{attrs:{large:""},on:{save:function(t){return e.updateProfile({gender:e.form.gender})},cancel:function(t){e.form.gender=e.individual.gender}},scopedSlots:e._u([{key:"input",fn:function(){return[t(h.Z,{attrs:{label:"Edit gender",maxlength:"30","single-line":""},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}})]},proxy:!0}],null,!1,1938252531)},[t("button",[e._v(" "+e._s(e.individual.gender||"none")+" "),t(m.Z,{staticClass:"icon--hidden aligned",attrs:{"aria-label":"Edit gender",small:""}},[e._v(" mdi-lead-pencil ")])],1)])],1)],1),t(f.Z,{staticClass:"ml-9"},[t(l.Z,{staticClass:"ml-6",attrs:{cols:"1"}},[t("span",[e._v("UUID:")])]),t(l.Z,[t("span",[e._v(e._s(e.individual.uuid))])])],1)],1)],1),t(f.Z,{staticClass:"section mb-4"},[t(d.Z,{attrs:{fluid:""}},[e.individual.identities?t("identities-list",{staticClass:"mb-8",attrs:{identities:e.individual.identities,uuid:e.individual.uuid,"is-locked":e.individual.isLocked},on:{unmerge:e.unmergeIdentities}}):e._e()],1)],1),t(f.Z,{staticClass:"section"},[t(d.Z,{attrs:{fluid:""}},[e.individual.enrollments?t("enrollment-list",{attrs:{enrollments:e.individual.enrollments,"is-locked":e.individual.isLocked},on:{openEnrollmentModal:e.confirmEnroll,openTeamModal:e.openTeamModal,updateEnrollment:e.updateEnrollment,withdraw:e.withdraw}}):e._e()],1)],1)],1),e.showRecommendations?t(l.Z,{attrs:{cols:"4",xl:"3"}},[t(d.Z,{staticClass:"section"},[t(k.Z,[e._v("Possible matches")]),e._l(e.individual.matchRecommendations,(function(n,i){var r=n.id,l=n.individual;return t("div",{key:r,staticClass:"ml-2 mr-2"},[t("individual-card",{class:{"mt-4":i>0,"mt-2":0===i},attrs:{name:l.name,email:l.email,enrollments:l.enrollments,identities:l.identities,"is-locked":l.isLocked,sources:l.sources,uuid:l.uuid}}),t(o.h7,[t(Z.Z),t(a.Z,{attrs:{text:"",small:""},on:{click:function(t){return t.preventDefault(),e.applyRecommendation(r,!1)}}},[e._v(" Dismiss ")]),t(a.Z,{attrs:{text:"",small:"",outlined:""},on:{click:function(t){return t.preventDefault(),e.applyRecommendation(r,!0)}}},[e._v(" Merge ")])],1)],1)}))],2)],1):e._e()],1)],1):t(d.Z,[t(i.Z,{attrs:{dense:"",text:"",type:"error"}},[e._v(" Individual "+e._s(e.mk)+" not found ")]),t(a.Z,{attrs:{to:"/",color:"primary",depressed:""}},[t(m.Z,{attrs:{left:"",dark:""}},[e._v("mdi-arrow-left")]),e._v(" Go to dashboard ")],1)],1),t("enroll-modal",{attrs:{"is-open":e.enrollmentModal.open,title:e.enrollmentModal.title,text:e.enrollmentModal.text,uuid:e.mk,enroll:e.enrollIndividual,"fetch-organizations":e.fetchOrganizations},on:{"update:isOpen":function(t){return e.$set(e.enrollmentModal,"open",t)},"update:is-open":function(t){return e.$set(e.enrollmentModal,"open",t)}}}),e.teamModal.open?t("team-enroll-modal",{attrs:{"is-open":e.teamModal.open,organization:e.teamModal.organization,uuid:e.mk,enroll:e.enroll},on:{"update:isOpen":function(t){return e.$set(e.teamModal,"open",t)},"update:is-open":function(t){return e.$set(e.teamModal,"open",t)},updateIndividual:function(t){return e.updateIndividual(t)}}}):e._e(),t(c.Z,{attrs:{"max-width":"500px"},model:{value:e.dialog.open,callback:function(t){e.$set(e.dialog,"open",t)},expression:"dialog.open"}},[t(r.Z,{staticClass:"pa-3"},[t(o.EB,{staticClass:"headline"},[e._v(e._s(e.dialog.title))]),t(o.ZB,[e.dialog.text?t("p",{staticClass:"pt-2 pb-2 text-body-2"},[e._v(" "+e._s(e.dialog.text)+" ")]):e._e(),e.dialog.errorMessage?t(i.Z,{attrs:{dense:"",text:"",type:"error"}},[e._v(" "+e._s(e.dialog.errorMessage)+" ")]):e._e()],1),e.dialog.action?t(o.h7,[t(Z.Z),t(a.Z,{attrs:{text:""},on:{click:e.closeDialog}},[e._v(" Cancel ")]),t(a.Z,{attrs:{color:"primary",id:"confirm",depressed:""},on:{click:function(t){return t.stopPropagation(),e.dialog.action.apply(null,arguments)}}},[e._v(" Confirm ")])],1):t(o.h7,[t(Z.Z),t(a.Z,{attrs:{text:"",color:"primary"},on:{click:e.closeDialog}},[e._v(" OK ")])],1)],1)],1)],1)}),b=[],y=n(6080),w=n(1907),$=n(5617),C=(n(2222),n(9826),n(1539),n(7658),n(9753),n(5246)),E=n(680),M=n(2729),L=n(5102),I=n(6491),P=n(1208),D=n(3106),O=n(7373),R=n(7671),S=n(4770);const j={name:"Individual",components:{Avatar:I.Z,IdentitiesList:P.Z,IndividualCard:D.Z,EnrollmentList:O.Z,EnrollModal:R.Z,TeamEnrollModal:S.Z},mixins:[L.f],data:function(){return{individual:{},form:{name:"",email:"",country:"",gender:""},dialog:{open:!1,title:"",text:"",errorMessage:"",action:null},teamModal:{open:!1,organization:""},countries:[]}},computed:{mk:function(){return this.$route.params.mk},showRecommendations:function(){return this.individual.matchRecommendations&&this.individual.matchRecommendations.length>0}},methods:{fetchIndividual:function(){var e=this;return(0,$.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,C.kA)(e.$apollo,e.mk);case 3:if(n=t.sent,0!==n.data.individuals.entities.length){t.next=7;break}return e.individual=!1,t.abrupt("return");case 7:e.updateIndividual(n.data.individuals.entities),Object.assign(e.form,{name:e.individual.name,email:e.individual.email,country:e.individual.country,gender:e.individual.gender}),document.title="".concat(e.individual.name," - Sorting Hat"),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},updateProfile:function(e){var t=this;return(0,$.Z)((0,w.Z)().mark((function n(){var i;return(0,w.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,E.ck)(t.$apollo,e,t.mk);case 3:i=n.sent,t.updateIndividual(i.data.updateProfile.individual),t.$logger.debug("Updated profile ".concat(t.mk),e),n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](0),t.dialog={open:!0,title:"Error updating profile",errorMessage:t.$getErrorMessage(n.t0)},t.$logger.error("Error updating profile: ".concat(n.t0),e);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))()},lock:function(){var e=this;return(0,$.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,E.H_)(e.$apollo,e.mk);case 3:n=t.sent,Object.assign(e.individual,{isLocked:n.data.lock.individual.isLocked}),e.$logger.debug("Locked individual ".concat(e.mk)),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),e.dialog={open:!0,title:"Error locking profile",errorMessage:e.$getErrorMessage(t.t0)},e.$logger.error("Error locking individual ".concat(e.mk,": ").concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},unlock:function(){var e=this;return(0,$.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,E.Yd)(e.$apollo,e.mk);case 3:n=t.sent,Object.assign(e.individual,{isLocked:n.data.unlock.individual.isLocked}),e.$logger.debug("Unlocked individual ".concat(e.mk)),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),e.dialog={open:!0,title:"Error updating profile",errorMessage:e.$getErrorMessage(t.t0)},e.$logger.error("Error unlocking individual ".concat(e.mk,": ").concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getCountryList:function(){var e=this;return(0,$.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,C.ox)(e.$apollo);case 3:n=t.sent,e.countries=n.data.countries.entities,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.dialog={open:!0,title:"Error loading country list",errorMessage:e.$getErrorMessage(t.t0)};case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},unmergeIdentities:function(e){var t=this;return(0,$.Z)((0,w.Z)().mark((function n(){var i,a;return(0,w.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,E.F7)(t.$apollo,e);case 3:i=n.sent,a=i.data.unmergeIdentities.individuals.find((function(e){return e.mk===t.mk})),t.updateIndividual(a),t.$logger.debug("Unmerged identities",e),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](0),t.dialog={open:!0,title:"Error updating profile",errorMessage:t.$getErrorMessage(n.t0)},t.$logger.error("Error unmerging identities ".concat(e,": ").concat(n.t0));case 13:case"end":return n.stop()}}),n,null,[[0,9]])})))()},enroll:function(e,t,n,i,a){var r=this;return(0,$.Z)((0,w.Z)().mark((function o(){var l;return(0,w.Z)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,(0,E.jb)(r.$apollo,e,t,n,i,a);case 2:return l=o.sent,o.abrupt("return",l);case 4:case"end":return o.stop()}}),o)})))()},updateEnrollment:function(e){var t=this;return(0,$.Z)((0,w.Z)().mark((function n(){var i;return(0,w.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Object.assign(e,{uuid:t.mk}),n.prev=1,n.next=4,(0,E.Ku)(t.$apollo,e);case 4:i=n.sent,t.updateIndividual(i.data.updateEnrollment.individual),t.$logger.debug("Updated enrollment",e),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),t.dialog={open:!0,title:"Error updating profile",errorMessage:t.$getErrorMessage(n.t0)},t.$logger.error("Error updating enrollment: ".concat(n.t0),e);case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},withdraw:function(e){var t=this;return(0,$.Z)((0,w.Z)().mark((function n(){var i,a,r,o,l;return(0,w.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.name,a=e.fromDate,r=e.toDate,o=e.parentOrg,n.prev=1,n.next=4,(0,E.XW)(t.$apollo,t.mk,i,a,r,o);case 4:l=n.sent,t.updateIndividual(l.data.withdraw.individual),t.$logger.debug("Removed affiliation",(0,y.Z)({uuid:t.mk},e)),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),t.dialog={open:!0,title:"Error updating profile",errorMessage:t.$getErrorMessage(n.t0)},t.$logger.error("Error removing affiliation: ".concat(n.t0),(0,y.Z)({uuid:t.mk},e));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})))()},deleteIndividual:function(){var e=this;return(0,$.Z)((0,w.Z)().mark((function t(){var n;return(0,w.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,E.dU)(e.$apollo,e.mk);case 3:n=t.sent,n&&e.$router.push("/"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.dialog={open:!0,title:"Error deleting profile",errorMessage:e.$getErrorMessage(t.t0)};case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},openTeamModal:function(e){this.teamModal={open:!0,organization:e}},confirmDelete:function(){this.dialog={open:!0,title:"Delete ".concat(this.individual.name,"?"),action:this.deleteIndividual}},closeDialog:function(){this.dialog={open:!1,title:"",text:"",errorMessage:""}},updateIndividual:function(e){Array.isArray(e)||(e=[e]),this.individual=(0,M.X7)(e[0])},fetchOrganizations:function(e,t,n){var i=this;return(0,$.Z)((0,w.Z)().mark((function a(){var r;return(0,w.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,C.xV)(i.$apollo,e,t,n);case 2:return r=a.sent,a.abrupt("return",r.data.organizations);case 4:case"end":return a.stop()}}),a)})))()},applyRecommendation:function(e,t){var n=this;return(0,$.Z)((0,w.Z)().mark((function i(){return(0,w.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,E.HD)(n.$apollo,e,t);case 3:n.fetchIndividual(),n.$logger.debug("Applied recommendation ".concat(e)),i.next=11;break;case 7:i.prev=7,i.t0=i["catch"](0),n.dialog={open:!0,title:"Error applying recommendation",errorMessage:n.$getErrorMessage(i.t0)},n.$logger.error("Error applying recommendation ".concat(e,": ").concat(i.t0));case 11:case"end":return i.stop()}}),i,null,[[0,7]])})))()}},mounted:function(){this.fetchIndividual()}},z=j;var B=n(1001),U=(0,B.Z)(z,_,b,!1,null,"9bc0803e",null);const A=U.exports},6035:(e,t,n)=>{n.d(t,{Z:()=>o});n(7327),n(1539),n(7941),n(6755),n(2222),n(9894),n(4198),n(3210),n(9600);var i=n(144);function a(e){return i.ZP.extend({name:"v-".concat(e),functional:!0,props:{id:String,tag:{type:String,default:"div"}},render:function(t,n){var i=n.props,a=n.data,r=n.children;a.staticClass="".concat(e," ").concat(a.staticClass||"").trim();var o=a.attrs;if(o){a.attrs={};var l=Object.keys(o).filter((function(e){if("slot"===e)return!1;var t=o[e];return e.startsWith("data-")?(a.attrs[e]=t,!1):t||"string"===typeof t}));l.length&&(a.staticClass+=" ".concat(l.join(" ")))}return i.id&&(a.domProps=a.domProps||{},a.domProps.id=i.id),t(i.tag,a,r)}})}var r=n(2653);const o=a("container").extend({name:"v-container",functional:!0,props:{id:String,tag:{type:String,default:"div"},fluid:{type:Boolean,default:!1}},render:function(e,t){var n,i=t.props,a=t.data,o=t.children,l=a.attrs;return l&&(a.attrs={},n=Object.keys(l).filter((function(e){if("slot"===e)return!1;var t=l[e];return e.startsWith("data-")?(a.attrs[e]=t,!1):t||"string"===typeof t}))),i.id&&(a.domProps=a.domProps||{},a.domProps.id=i.id),e(i.tag,(0,r.ZP)(a,{staticClass:"container",class:Array({"container--fluid":i.fluid}).concat(n||[])}),o)}})}}]);