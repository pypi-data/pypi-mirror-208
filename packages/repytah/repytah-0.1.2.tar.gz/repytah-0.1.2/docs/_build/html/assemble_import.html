<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assemble &mdash; repytah 0.1.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Search" href="search_import.html" />
    <link rel="prev" title="Transform" href="transform_import.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/repytah_logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">Why repytah</a></li>
<li class="toctree-l1"><a class="reference internal" href="recommended_installation.html">Installing from <cite>conda</cite> package-manager or from <cite>pip</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="general_installation.html">Install from <cite>pip</cite> or <cite>conda</cite></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="utilities_import.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_import.html">Transform</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Assemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="search_import.html">Search</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Implementation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="function_pipeline.html">Function Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">A Quick Start to Use the Package <code class="docutils literal notranslate"><span class="pre">repytah</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="example_vignette.html">Example of Creating Aligned Hierarchies for a Mazurka Score</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">repytah</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Assemble</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/assemble_import.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-repytah.assemble">
<span id="assemble"></span><h1>Assemble<a class="headerlink" href="#module-repytah.assemble" title="Permalink to this heading"></a></h1>
<p>assemble.py</p>
<p>This module finds and forms essential structure components, which are the
smallest building blocks that form every repeat in the song.</p>
<p>These functions ensure that each time step of a song is contained in at most
one of the song’s essential structure components by checking that there are no
overlapping repeats in time. When repeats overlap, they undergo a process
where they are divided until there are only non-overlapping pieces left.</p>
<p>The module contains the following functions:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>breakup_overlaps_by_intersect</dt><dd><p>Extracts repeats in input_pattern_obj that has the starting indices
of the repeats, into the essential structure components using bw_vec,
that has the lengths of each repeat.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>check_overlaps</dt><dd><p>Compares every pair of groups, determining if there are any repeats
in any pairs of the groups that overlap.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>__compare_and_cut</dt><dd><p>Compares two rows of repeats labeled RED and BLUE, and determines if
there are any overlaps in time between them. If there are overlaps,
we cut the repeats in RED and BLUE into up to 3 pieces.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>__num_of_parts</dt><dd><p>Determines the number of blocks of consecutive time steps in a list
of time steps. A block of consecutive time steps represents a
distilled section of a repeat.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>__inds_to_rows</dt><dd><p>Expands a vector containing the starting indices of a piece or two
of a repeat into a matrix representation recording when these pieces
occur in the song with 1’s. All remaining entries are marked with
0’s.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>__merge_based_on_length</dt><dd><p>Merges repeats that are the same length, as set by full_bandwidth,
and are repeats of the same piece of structure.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>__merge_rows</dt><dd><p>Merges rows that have at least one common repeat. These common
repeat(s) must occur at the same time step and be of a common length.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>hierarchical_structure</dt><dd><p>Distills the repeats encoded in matrix_no_overlaps (and key_no_overlaps)
to the essential structure components and then builds the hierarchical
representation. Optionally outputs visualizations of the hierarchical
representations.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.breakup_overlaps_by_intersect">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">breakup_overlaps_by_intersect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_pattern_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bw_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_bw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.breakup_overlaps_by_intersect" title="Permalink to this definition"></a></dt>
<dd><p>Extracts repeats in input_pattern_obj that has the starting indices of the
repeats, into the essential structure components using bw_vec, that has the
lengths of each repeat. The essential structure components are the
smallest building blocks that form every repeat in the song.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_pattern_obj</strong> (<em>np.ndarray</em>) – Binary matrix with 1’s where repeats begin and 0’s otherwise.</p></li>
<li><p><strong>bw_vec</strong> (<em>np.ndarray</em>) – Vector containing the lengths of the repeats encoded in
input_pattern_obj.</p></li>
<li><p><strong>thresh_bw</strong> (<em>int</em>) – One less than the smallest allowable repeat length.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple (pattern_no_overlaps, pattern_no_overlaps_key) where all
variables have data type np.ndarray.</p>
<p>pattern_no_overlaps is a binary matrix with 1’s where repeats
of essential structure components begin.</p>
<p>pattern_no_overlaps_key is a vector containing the lengths of the
repeats of essential structure components in pattern_no_overlaps.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.check_overlaps">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">check_overlaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.check_overlaps" title="Permalink to this definition"></a></dt>
<dd><p>Compares every pair of repeat groups and determines if there are any repeats
in any pairs of the groups that overlap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_mat</strong> (<em>np.ndarray</em>) – Binary matrix with blocks of 1’s equal to the length of repeats
to be checked for overlaps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Logical array where (i,j) = 1 if row i of input_mat and row j
of input_mat overlap and (i,j) = 0 elsewhere.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>overlap_mat (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.__compare_and_cut">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">__compare_and_cut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue_len</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.__compare_and_cut" title="Permalink to this definition"></a></dt>
<dd><p>Compares two rows of repeats labeled RED and BLUE, and determines if there
are any overlaps in time between them. If there is, then we cut the
repeats in RED and BLUE into up to 3 pieces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>red</strong> (<em>np.ndarray</em>) – Binary row vector encoding a set of repeats with 1’s where each
repeat starts and 0’s otherwise.</p></li>
<li><p><strong>red_len</strong> (<em>np.ndarray</em>) – Length of repeats encoded in red.</p></li>
<li><p><strong>blue</strong> (<em>np.ndarray</em>) – Binary row vector encoding a set of repeats with 1’s where each
repeat starts and 0’s otherwise.</p></li>
<li><p><strong>blue_len</strong> (<em>np.ndarray</em>) – Length of repeats encoded in blue.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple (union_mat, union_length) where all variables have data type
np.ndarray.</p>
<p>union_mat is a binary matrix representation of up to three rows encoding
non-overlapping repeats cut from red and blue.</p>
<p>union_length is a vector containing the lengths of the repeats encoded
in union_mat.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.__num_of_parts">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">__num_of_parts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_all_starts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.__num_of_parts" title="Permalink to this definition"></a></dt>
<dd><p>Determines the number of blocks of consecutive time steps in a list of
time steps. A block of consecutive time steps represents a distilled
section of a repeat. This distilled section will be replicated and the
starting indices of the repeats within it will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_vec</strong> (<em>np.ndarray</em>) – Vector that contains one or two parts of a repeat that are
overlap(s) in time that may need to be replicated.</p></li>
<li><p><strong>input_start</strong> (<em>np.ndarray</em>) – Starting index for the part to be replicated.</p></li>
<li><p><strong>input_all_starts</strong> (<em>np.ndarray</em>) – Starting indices for replication.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple (start_mat, length_vec) where all variables have data type
np.ndarray.</p>
<p>start_mat is an array of one or two rows containing the starting indices
of the replicated repeats.</p>
<p>length_vec is a column vector containing the lengths of the replicated
parts.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.__inds_to_rows">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">__inds_to_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.__inds_to_rows" title="Permalink to this definition"></a></dt>
<dd><p>Expands a vector containing the starting indices of a piece or two of a
repeat into a matrix representation recording when these pieces occur in
the song with 1’s. All remaining entries are marked with 0’s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_mat</strong> (<em>np.ndarray</em>) – Matrix of one or two rows, containing the starting indices.</p></li>
<li><p><strong>row_length</strong> (<em>int</em>) – Length of the rows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Binary matrix of one or two rows, with 1’s where the starting
indices and 0’s otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>new_mat (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.__merge_based_on_length">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">__merge_based_on_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_bw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_bw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.__merge_based_on_length" title="Permalink to this definition"></a></dt>
<dd><p>Merges repeats that are the same length, as set by full_bw,
and are repeats of the same piece of structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_mat</strong> (<em>np.ndarray</em>) – Binary matrix with ones where repeats start and zeroes otherwise.</p></li>
<li><p><strong>full_bw</strong> (<em>np.ndarray</em>) – Length of repeats encoded in input_mat.</p></li>
<li><p><strong>target_bw</strong> (<em>np.ndarray</em>) – Lengths of repeats that we seek to merge.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple (out_mat, one_length_vec) where all variables have data type
np.ndarray.</p>
<p>out_mat is a binary matrix with 1’s where repeats start and 0’s
otherwise with rows of full_mat merged if appropriate.</p>
<p>one_length_vec is a vector that contains the length of repeats encoded
in out_mat.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.__merge_rows">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">__merge_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_width</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.__merge_rows" title="Permalink to this definition"></a></dt>
<dd><p>Merges rows that have at least one common repeat; said common repeat(s)
must occur at the same time step and be of common length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_mat</strong> (<em>np.ndarray</em>) – Binary matrix with ones where repeats start and zeroes otherwise.</p></li>
<li><p><strong>input_width</strong> (<em>int</em>) – Length of repeats encoded in input_mat.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Binary matrix with ones where repeats start and zeroes otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>merge_mat (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="repytah.assemble.hierarchical_structure">
<span class="sig-prename descclassname"><span class="pre">repytah.assemble.</span></span><span class="sig-name descname"><span class="pre">hierarchical_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix_no_overlaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_no_overlaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#repytah.assemble.hierarchical_structure" title="Permalink to this definition"></a></dt>
<dd><p>Distills the repeats encoded in matrix_no_overlaps (and key_no_overlaps)
to the essential structure components and then builds the hierarchical
representation. Optionally shows visualizations of the hierarchical
structure via the vis argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix_no_overlaps</strong> (<em>np.ndarray</em>) – Binary matrix with 1’s where repeats begin and 0’s otherwise.</p></li>
<li><p><strong>key_no_overlaps</strong> (<em>np.ndarray</em>) – Vector containing the lengths of the repeats encoded
in matrix_no_overlaps.</p></li>
<li><p><strong>sn</strong> (<em>int</em>) – </p></li>
<li><p><strong>length</strong> (<em>Song</em>) – </p></li>
<li><p><strong>shingles.</strong> (<em>which is the number of audio</em>) – </p></li>
<li><p><strong>vis</strong> (<em>bool</em>) – Shows visualizations if True (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A tuple (full_visualization, full_key, full_matrix_no_overlaps,
full_anno_lst) where all variables have data type np.ndarray.</p>
<p>full_visualization is a binary matrix representation for
full_matrix_no_overlaps with blocks of 1’s equal to the lengths
prescribed in full_key.</p>
<p>full_key is a vector containing the lengths of the hierarchical
structure encoded in full_matrix_no_overlaps.</p>
<p>full_matrix_no_overlaps is a binary matrix with 1’s where hierarchical
structure begins and 0’s otherwise.</p>
<p>full_anno_lst is a vector containing the annotation markers of the
hierarchical structure encoded in each row of full_matrix_no_overlaps.</p>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="transform_import.html" class="btn btn-neutral float-left" title="Transform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="search_import.html" class="btn btn-neutral float-right" title="Search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, repytah development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>